<!-- build time:Sun Nov 11 2018 15:00:55 GMT+0800 (中国标准时间) --><!DOCTYPE html><html class="theme-next gemini use-motion" lang="zh-CN"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=2"><meta name="theme-color" content="#222"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><meta name="google-site-verification" content="true"><link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css"><link href="/css/main.css?v=6.4.0" rel="stylesheet" type="text/css"><link rel="apple-touch-icon" sizes="180x180" href="/images/apple.png?v=6.4.0"><link rel="icon" type="image/png" sizes="32x32" href="/images/favicon32.png?v=6.4.0"><link rel="icon" type="image/png" sizes="16x16" href="/images/favicon16.png?v=6.4.0"><script type="text/javascript" id="hexo.configurations">var NexT=window.NexT||{},CONFIG={root:"/",scheme:"Gemini",version:"6.4.0",sidebar:{position:"right",display:"post",offset:12,b2t:!1,scrollpercent:!1,onmobile:!1},fancybox:!1,fastclick:!1,lazyload:!1,tabs:!0,motion:{enable:!0,async:!1,transition:{post_block:"fadeIn",post_header:"slideDownIn",post_body:"slideDownIn",coll_header:"slideLeftIn",sidebar:"slideUpIn"}},algolia:{applicationID:"",apiKey:"",indexName:"",hits:{per_page:10},labels:{input_placeholder:"Search for Posts",hits_empty:"We didn't find any results for the search: ${query}",hits_stats:"${hits} results found in ${time} ms"}}}</script><meta name="keywords" content="没有关键字"><meta property="og:type" content="website"><meta property="og:title" content="蓝生的博客"><meta property="og:url" content="https://www.lansheng.net.cn/page/23/index.html"><meta property="og:site_name" content="蓝生的博客"><meta property="og:locale" content="zh-CN"><meta name="twitter:card" content="summary"><meta name="twitter:title" content="蓝生的博客"><link rel="alternate" href="/atom.xml" title="蓝生的博客" type="application/atom+xml"><link rel="canonical" href="https://www.lansheng.net.cn/page/23/"><script type="text/javascript" id="page.configurations">CONFIG.page={sidebar:""}</script><title>蓝生的博客</title><noscript><style type="text/css">.sidebar-inner,.use-motion .brand,.use-motion .collection-title,.use-motion .comments,.use-motion .menu-item,.use-motion .motion-element,.use-motion .pagination,.use-motion .post-block,.use-motion .post-body,.use-motion .post-header{opacity:initial}.use-motion .logo,.use-motion .site-subtitle,.use-motion .site-title{opacity:initial;top:initial}</style></noscript></head><body itemscope itemtype="http://schema.org/WebPage" lang="zh-CN"><div class="container sidebar-position-right page-home"><div class="headband"></div><header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="header-inner"><div class="site-brand-wrapper"><div class="site-meta"><div class="custom-logo-site-title"><a href="/" class="brand" rel="start"><span class="logo-line-before"><i></i></span> <span class="site-title">蓝生的博客</span> <span class="logo-line-after"><i></i></span></a></div></div><div class="site-nav-toggle"><button aria-label="切换导航栏"><span class="btn-bar"></span> <span class="btn-bar"></span> <span class="btn-bar"></span></button></div></div><nav class="site-nav"><ul id="menu" class="menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="menu-item-icon fa fa-fw fa-home"></i><br>首页</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="menu-item-icon fa fa-fw fa-th"></i><br>分类</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="menu-item-icon fa fa-fw fa-archive"></i><br>归档</a></li><li class="menu-item menu-item-search"><a href="javascript:;" class="popup-trigger"><i class="menu-item-icon fa fa-search fa-fw"></i><br>搜索</a></li></ul><div class="site-search"><div class="popup search-popup local-search-popup"><div class="local-search-header clearfix"><span class="search-icon"><i class="fa fa-search"></i> </span><span class="popup-btn-close"><i class="fa fa-times-circle"></i></span><div class="local-search-input-wrapper"><input autocomplete="off" placeholder="搜索..." spellcheck="false" type="text" id="local-search-input"></div></div><div id="local-search-result"></div></div></div></nav></div></header><main id="main" class="main"><div class="main-inner"><div class="content-wrap"><div id="content" class="content"><section id="posts" class="posts-expand"><article class="post post-type-normal" itemscope itemtype="http://schema.org/Article"><div class="post-block"><link itemprop="mainEntityOfPage" href="https://www.lansheng.net.cn/blog/a84bbd3e/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="name" content="蓝生"><meta itemprop="description" content=""><meta itemprop="image" content="/images/avatar.jpg"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="蓝生的博客"></span><header class="post-header"><h1 class="post-title" itemprop="name headline"><a class="post-title-link" href="/blog/a84bbd3e/" itemprop="url">从网页上复制表格生产markdown表格</a></h1><div class="post-meta"><span class="post-time"><span class="post-meta-item-icon"><i class="fa fa-calendar-o"></i> </span><span class="post-meta-item-text">发表于</span> <time title="创建时间：2018-08-06 15:47:54" itemprop="dateCreated datePublished" datetime="2018-08-06T15:47:54+08:00">2018-08-06</time> <span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="fa fa-calendar-check-o"></i> </span><span class="post-meta-item-text">更新于</span> <time title="修改时间：2018-11-05 17:17:07" itemprop="dateModified" datetime="2018-11-05T17:17:07+08:00">2018-11-05</time> </span><span class="post-category"><span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="fa fa-folder-o"></i> </span><span class="post-meta-item-text">分类于</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Java/" itemprop="url" rel="index"><span itemprop="name">Java</span></a></span> ， <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Java/Java-正则表达式/" itemprop="url" rel="index"><span itemprop="name">Java 正则表达式</span></a></span> </span><span class="post-comments-count"><span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="fa fa-comment-o"></i> </span><a href="/blog/a84bbd3e/#comments" itemprop="discussionUrl"><span class="post-meta-item-text">评论数：</span> <span class="post-comments-count valine-comment-count" data-xid="/blog/a84bbd3e/" itemprop="commentCount"></span></a></span></div></header><div class="post-body" itemprop="articleBody"><h2 id="需求分析"><a href="#需求分析" class="headerlink" title="需求分析"></a>需求分析</h2><p>例如我这里有一个表格：<br><img src="https://i.imgur.com/WqedYrX.png" alt=""><br>表格里的文本是可复制的，复制下来的文本如下。<br></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">序号 	方法 	描述</span><br><span class="line">1 	public URL(String spec) throws MalformedURLException 	根据 String 表示形式的地址创建 URL 对象。</span><br><span class="line">2 	public URL(String protocol,String host,int port,String file) throws MalformedURLException 	创建URL对象，并指定协议protocol，主机host，端口名称port，资源文件名file</span><br><span class="line">3 	public URLConnection openConnection() throws IOException 	返回一个 URLConnection 对象，它表示到 URL 所引用的远程对象的连接。</span><br><span class="line">4 	public final InputStream openStream() throws IOException 	打开到此 URL 的连接并返回一个用于从该连接读入的 InputStream</span><br></pre></td></tr></table></figure><p></p><p>现在需要，把这个复制下来的文本生成markdown表格。</p><h2 id="基本实现"><a href="#基本实现" class="headerlink" title="基本实现"></a>基本实现</h2><p>观察这个文本，我发现，每个单元格之间不多不少刚好有两个空白符，所以，只要发现有两个空白符的地方我就认为表格中单元格之间的边界。<br>代码如下所示：<br></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line">package regex.tools;</span><br><span class="line"></span><br><span class="line">import java.util.Scanner;</span><br><span class="line">import clipboard.util.SysClipboardUtil;</span><br><span class="line"></span><br><span class="line">public class MDtable</span><br><span class="line">&#123;</span><br><span class="line">	public static void main(String[] args)</span><br><span class="line">	&#123;</span><br><span class="line">		String text=SysClipboardUtil.getSysClipboardText();</span><br><span class="line">		System.out.println(text);</span><br><span class="line">		Scanner scanner=new Scanner(text);</span><br><span class="line">		String line;</span><br><span class="line">		String[] fragments;</span><br><span class="line">		System.out.println(&quot;-------------------------------------------&quot;);</span><br><span class="line">		boolean flag=true;</span><br><span class="line">		while(scanner.hasNextLine())</span><br><span class="line">		&#123;</span><br><span class="line">			line=scanner.nextLine();</span><br><span class="line">			//刚好两个的地方分割</span><br><span class="line">			fragments=line.split(&quot;\\s&#123;2&#125;&quot;);</span><br><span class="line">//			System.out.println(&quot;line:---&gt;&quot;);</span><br><span class="line">//			System.out.println(&quot;fragments:&quot;);</span><br><span class="line">			System.out.print(&quot;|&quot;);</span><br><span class="line">			for (String string : fragments)</span><br><span class="line">			&#123;</span><br><span class="line">				System.out.print(string+&quot;|&quot;);</span><br><span class="line">			&#125;</span><br><span class="line">			System.out.println();</span><br><span class="line">			//打印表格对其方式,使用默认对齐方式</span><br><span class="line">			if(flag)</span><br><span class="line">			&#123;</span><br><span class="line">				System.out.print(&quot;|&quot;);</span><br><span class="line">				for(int i=0;i&lt;fragments.length;i++)</span><br><span class="line">				&#123;</span><br><span class="line">					System.out.print(&quot;-|&quot;);</span><br><span class="line">				&#125;</span><br><span class="line">				System.out.println();</span><br><span class="line">				flag=false;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p></p><h3 id="测试"><a href="#测试" class="headerlink" title="测试"></a>测试</h3><p>复制表格中的文字<br><img src="https://i.imgur.com/TNm26e9.png" alt=""><br>然后运行上面的代码，运行结果如下。<br></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">序号 	方法 	描述</span><br><span class="line">1 	public URL(String spec) throws MalformedURLException 	根据 String 表示形式的地址创建 URL 对象。</span><br><span class="line">2 	public URL(String protocol,String host,int port,String file) throws MalformedURLException 	创建URL对象，并指定协议protocol，主机host，端口名称port，资源文件名file</span><br><span class="line">3 	public URLConnection openConnection() throws IOException 	返回一个 URLConnection 对象，它表示到 URL 所引用的远程对象的连接。</span><br><span class="line">4 	public final InputStream openStream() throws IOException 	打开到此 URL 的连接并返回一个用于从该连接读入的 InputStream</span><br><span class="line">-------------------------------------------</span><br><span class="line">|序号|方法|描述|</span><br><span class="line">|-|-|-|</span><br><span class="line">|1|public URL(String spec) throws MalformedURLException|根据 String 表示形式的地址创建 URL 对象。|</span><br><span class="line">|2|public URL(String protocol,String host,int port,String file) throws MalformedURLException|创建URL对象，并指定协议protocol，主机host，端口名称port，资源文件名file|</span><br><span class="line">|3|public URLConnection openConnection() throws IOException|返回一个 URLConnection 对象，它表示到 URL 所引用的远程对象的连接。|</span><br><span class="line">|4|public final InputStream openStream() throws IOException|打开到此 URL 的连接并返回一个用于从该连接读入的 InputStream|</span><br></pre></td></tr></table></figure><p></p><h3 id="效果"><a href="#效果" class="headerlink" title="效果"></a>效果</h3><p>把markdown表格代码粘贴到markdown文档中，效果如下。</p><table><thead><tr><th>序号</th><th>方法</th><th>描述</th></tr></thead><tbody><tr><td>1</td><td>public URL(String spec) throws MalformedURLException</td><td>根据 String 表示形式的地址创建 URL 对象。</td></tr><tr><td>2</td><td>public URL(String protocol,String host,int port,String file) throws MalformedURLException</td><td>创建URL对象，并指定协议protocol，主机host，端口名称port，资源文件名file</td></tr><tr><td>3</td><td>public URLConnection openConnection() throws IOException</td><td>返回一个 URLConnection 对象，它表示到 URL 所引用的远程对象的连接。</td></tr><tr><td>4</td><td>public final InputStream openStream() throws IOException</td><td>打开到此 URL 的连接并返回一个用于从该连接读入的 InputStream</td></tr></tbody></table><p>可以看到这样就很容易的复制一个表格了。</p><h2 id="代码优化"><a href="#代码优化" class="headerlink" title="代码优化"></a>代码优化</h2><h3 id="Java复制网上表格的方法"><a href="#Java复制网上表格的方法" class="headerlink" title="Java复制网上表格的方法"></a>Java复制网上表格的方法</h3><p>把上面的代码封装成方法：<br></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line">/**</span><br><span class="line"> * 生成markdown表格。</span><br><span class="line"> * @param text 复制的表格文字</span><br><span class="line"> * @return markdown表格代码</span><br><span class="line"> */</span><br><span class="line">public static String toMarkdownTable(String text)</span><br><span class="line">&#123;</span><br><span class="line">	StringBuilder sBuider=new StringBuilder();</span><br><span class="line">	Scanner scanner=new Scanner(text);</span><br><span class="line">	String line;</span><br><span class="line">	String[] fragments;</span><br><span class="line">	boolean flag=true;</span><br><span class="line">	while(scanner.hasNextLine())</span><br><span class="line">	&#123;</span><br><span class="line">		line=scanner.nextLine();</span><br><span class="line">		//刚好两个的地方分割</span><br><span class="line">		fragments=line.split(&quot;\\s&#123;2&#125;&quot;);</span><br><span class="line">//			System.out.print(&quot;|&quot;);</span><br><span class="line">		sBuider.append(&quot;|&quot;);</span><br><span class="line">		for (String string : fragments)</span><br><span class="line">		&#123;</span><br><span class="line">//				System.out.print(string+&quot;|&quot;);</span><br><span class="line">			sBuider.append(string+&quot;|&quot;);</span><br><span class="line">		&#125;</span><br><span class="line">//			System.out.println();</span><br><span class="line">		sBuider.append(&quot;\n&quot;);</span><br><span class="line">		//打印表格对其方式,使用默认对齐方式</span><br><span class="line">		if(flag)</span><br><span class="line">		&#123;</span><br><span class="line">//				System.out.print(&quot;|&quot;);</span><br><span class="line">			sBuider.append(&quot;|&quot;);</span><br><span class="line">			for(int i=0;i&lt;fragments.length;i++)</span><br><span class="line">			&#123;</span><br><span class="line">//					System.out.print(&quot;-|&quot;);</span><br><span class="line">				sBuider.append(&quot;-|&quot;);</span><br><span class="line">			&#125;</span><br><span class="line">//				System.out.println();</span><br><span class="line">			sBuider.append(&quot;\n&quot;);</span><br><span class="line">			flag=false;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	return sBuider.toString();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p></p><h3 id="调用方式"><a href="#调用方式" class="headerlink" title="调用方式"></a>调用方式</h3><p>调用：<br></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">public static void main(String[] args)</span><br><span class="line">&#123;</span><br><span class="line">	//从剪贴板获取文本</span><br><span class="line">	String text=SysClipboardUtil.getSysClipboardText();</span><br><span class="line">	//写回剪贴板</span><br><span class="line">	SysClipboardUtil.setSysClipboardText(toMarkdownTable(text));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p></p><h3 id="运行结果"><a href="#运行结果" class="headerlink" title="运行结果"></a>运行结果</h3><p>控制台没有输出，markdown表格代码已经写到剪贴板中去了，不再粘贴，效果和上面的一致。</p><h3 id="依赖类："><a href="#依赖类：" class="headerlink" title="依赖类："></a>依赖类：</h3><p>依赖类：<a href="https://blog.csdn.net/qq_21808961/article/details/80671259" target="_blank" rel="noopener">clipboard.util.SysClipboardUtil</a></p><h3 id="完整的代码："><a href="#完整的代码：" class="headerlink" title="完整的代码："></a>完整的代码：</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line">package regex.tools;</span><br><span class="line"></span><br><span class="line">import java.util.Scanner;</span><br><span class="line">import clipboard.util.SysClipboardUtil;</span><br><span class="line"></span><br><span class="line">public class MDtable</span><br><span class="line">&#123;</span><br><span class="line">	public static void main(String[] args)</span><br><span class="line">	&#123;</span><br><span class="line">		// 从剪贴板获取文本</span><br><span class="line">		String text = SysClipboardUtil.getSysClipboardText();</span><br><span class="line">		// 写回剪贴板</span><br><span class="line">		SysClipboardUtil.setSysClipboardText(toMarkdownTable(text));</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	/**</span><br><span class="line">	 * 生成markdown表格。</span><br><span class="line">	 * </span><br><span class="line">	 * @param text</span><br><span class="line">	 *            复制的表格文字</span><br><span class="line">	 * @return markdown表格代码</span><br><span class="line">	 */</span><br><span class="line">	public static String toMarkdownTable(String text)</span><br><span class="line">	&#123;</span><br><span class="line">		StringBuilder sBuider = new StringBuilder();</span><br><span class="line">		Scanner scanner = new Scanner(text);</span><br><span class="line">		String line;</span><br><span class="line">		String[] fragments;</span><br><span class="line">		// System.out.println(&quot;-------------------------------------------&quot;);</span><br><span class="line">		boolean flag = true;</span><br><span class="line">		while (scanner.hasNextLine())</span><br><span class="line">		&#123;</span><br><span class="line">			line = scanner.nextLine();</span><br><span class="line">			// 刚好两个的地方分割</span><br><span class="line">			fragments = line.split(&quot;\\s&#123;2&#125;&quot;);</span><br><span class="line">			// System.out.println(&quot;line:---&gt;&quot;);</span><br><span class="line">			// System.out.println(&quot;fragments:&quot;);</span><br><span class="line">			// System.out.print(&quot;|&quot;);</span><br><span class="line">			sBuider.append(&quot;|&quot;);</span><br><span class="line">			for (String string : fragments)</span><br><span class="line">			&#123;</span><br><span class="line">				// System.out.print(string+&quot;|&quot;);</span><br><span class="line">				sBuider.append(string + &quot;|&quot;);</span><br><span class="line">			&#125;</span><br><span class="line">			// System.out.println();</span><br><span class="line">			sBuider.append(&quot;\n&quot;);</span><br><span class="line">			// 打印表格对其方式,使用默认对齐方式</span><br><span class="line">			if (flag)</span><br><span class="line">			&#123;</span><br><span class="line">				// System.out.print(&quot;|&quot;);</span><br><span class="line">				sBuider.append(&quot;|&quot;);</span><br><span class="line">				for (int i = 0; i &lt; fragments.length; i++)</span><br><span class="line">				&#123;</span><br><span class="line">					// System.out.print(&quot;-|&quot;);</span><br><span class="line">					sBuider.append(&quot;-|&quot;);</span><br><span class="line">				&#125;</span><br><span class="line">				// System.out.println();</span><br><span class="line">				sBuider.append(&quot;\n&quot;);</span><br><span class="line">				flag = false;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		return sBuider.toString();</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>本文链接: <a href="https://www.lansheng.net.cn/blog/a84bbd3e/">从网页上复制表格生产markdown表格</a></p></div><footer class="post-footer"><div class="post-eof"></div></footer></div></article><article class="post post-type-normal" itemscope itemtype="http://schema.org/Article"><div class="post-block"><link itemprop="mainEntityOfPage" href="https://www.lansheng.net.cn/blog/728ca7fc/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="name" content="蓝生"><meta itemprop="description" content=""><meta itemprop="image" content="/images/avatar.jpg"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="蓝生的博客"></span><header class="post-header"><h1 class="post-title" itemprop="name headline"><a class="post-title-link" href="/blog/728ca7fc/" itemprop="url">MarkdownPad 导出html带侧边栏目录</a></h1><div class="post-meta"><span class="post-time"><span class="post-meta-item-icon"><i class="fa fa-calendar-o"></i> </span><span class="post-meta-item-text">发表于</span> <time title="创建时间：2018-08-06 01:09:47" itemprop="dateCreated datePublished" datetime="2018-08-06T01:09:47+08:00">2018-08-06</time> <span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="fa fa-calendar-check-o"></i> </span><span class="post-meta-item-text">更新于</span> <time title="修改时间：2018-11-05 17:17:08" itemprop="dateModified" datetime="2018-11-05T17:17:08+08:00">2018-11-05</time> </span><span class="post-category"><span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="fa fa-folder-o"></i> </span><span class="post-meta-item-text">分类于</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/markdown使用/" itemprop="url" rel="index"><span itemprop="name">markdown使用</span></a></span> ， <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/markdown使用/markdown编辑器/" itemprop="url" rel="index"><span itemprop="name">markdown编辑器</span></a></span> </span><span class="post-comments-count"><span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="fa fa-comment-o"></i> </span><a href="/blog/728ca7fc/#comments" itemprop="discussionUrl"><span class="post-meta-item-text">评论数：</span> <span class="post-comments-count valine-comment-count" data-xid="/blog/728ca7fc/" itemprop="commentCount"></span></a></span></div></header><div class="post-body" itemprop="articleBody"><p>参考：<a href="https://blog.csdn.net/zwx_lucky/article/details/53998930" target="_blank" rel="noopener">https://blog.csdn.net/zwx_lucky/article/details/53998930</a><br>原文给的代码如下：个人觉得不足的地方是没有自动编号，虽然使用了缩进但是父子标题看起来不是很明显，我在此基础加上了点代码<a href="#Mark">实现在标题前面自动编号</a>。<br></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br></pre></td><td class="code"><pre><span class="line">&lt;!--bookmark --&gt;</span><br><span class="line">&lt;script src=&quot;http://code.jquery.com/jquery-1.7.2.min.js&quot;&gt;&lt;/script&gt;</span><br><span class="line">&lt;script src=&quot;http://yandex.st/highlightjs/6.2/highlight.min.js&quot;&gt;&lt;/script&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&lt;script&gt;hljs.initHighlightingOnLoad();&lt;/script&gt;</span><br><span class="line">&lt;script type=&quot;text/javascript&quot;&gt;</span><br><span class="line"> $(document).ready(function()&#123;</span><br><span class="line"></span><br><span class="line">      $(&quot;h1,h2,h3,h4,h5,h6&quot;).each(function(i,item)&#123;</span><br><span class="line">        var tag = $(item).get(0).localName;</span><br><span class="line">        $(item).attr(&quot;id&quot;,&quot;wow&quot;+i);</span><br><span class="line">        $(&quot;#category&quot;).append(&apos;&lt;a class=&quot;new&apos;+tag+&apos;&quot; href=&quot;#wow&apos;+i+&apos;&quot;&gt;&apos;+$(this).text()+&apos;&lt;/a&gt;&lt;/br&gt;&apos;);</span><br><span class="line">        $(&quot;.newh1&quot;).css(&quot;margin-left&quot;,0);</span><br><span class="line">        $(&quot;.newh2&quot;).css(&quot;margin-left&quot;,20);</span><br><span class="line">        $(&quot;.newh3&quot;).css(&quot;margin-left&quot;,40);</span><br><span class="line">        $(&quot;.newh4&quot;).css(&quot;margin-left&quot;,60);</span><br><span class="line">        $(&quot;.newh5&quot;).css(&quot;margin-left&quot;,80);</span><br><span class="line">      	$(&quot;.newh6&quot;).css(&quot;margin-left&quot;,100);</span><br><span class="line">      &#125;);</span><br><span class="line"></span><br><span class="line">       $(&quot;.book-body&quot;).html($(&quot;.book-body&quot;).nextAll())</span><br><span class="line"> &#125;);</span><br><span class="line">&lt;/script&gt;</span><br><span class="line">&lt;style type=&quot;text/css&quot;&gt;</span><br><span class="line"></span><br><span class="line">@media (max-width: 1600px) &#123;</span><br><span class="line">    .book-body &#123;</span><br><span class="line">       padding-left:200px;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">@media (max-width: 1400px) &#123;</span><br><span class="line">    .book-body &#123;</span><br><span class="line">       padding-left:200px;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">@media (max-width: 1200px) &#123;</span><br><span class="line">    .book-body &#123;</span><br><span class="line">       padding-left:300px;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">@media (max-width: 700px) &#123;</span><br><span class="line">    .book-body &#123;</span><br><span class="line">       padding-left:0px;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">@media (min-width: 600px) &#123;</span><br><span class="line">    #category&#123;</span><br><span class="line">        position: fixed;</span><br><span class="line">        left: 20px;</span><br><span class="line">        top:0;</span><br><span class="line">        height: 100%;</span><br><span class="line">        overflow-y: scroll;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">@media (-webkit-max-device-pixel-ratio: 1) &#123;</span><br><span class="line">    ::-webkit-scrollbar-track-piece &#123;</span><br><span class="line">        background-color:#FFF</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    ::-webkit-scrollbar &#123;</span><br><span class="line">        width: 6px;</span><br><span class="line">        height: 6px</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    ::-webkit-scrollbar-thumb &#123;</span><br><span class="line">        background-color: #c2c2c2;</span><br><span class="line">        background-clip: padding-box;</span><br><span class="line">        min-height: 28px</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    ::-webkit-scrollbar-thumb:hover &#123;</span><br><span class="line">        background-color: #A0A0A0</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&lt;/style&gt;</span><br><span class="line">&lt;a href=&quot;javascript:scroll(0,0)&quot; style=&quot;position:fixed;float:right;right:32px;top:70%&quot;&gt;返回顶部&lt;/a&gt; </span><br><span class="line">&lt;div style=&quot;width:20%;&quot; id=&quot;category&quot; class=&quot;book-summary&quot;&gt;&lt;/div&gt;</span><br><span class="line">&lt;div class=&quot;book-body&quot;&gt;</span><br><span class="line">&lt;/div&gt;</span><br></pre></td></tr></table></figure><p></p><p>实现方式2：缺点是书签在顶部，不好快速跳转<br></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br></pre></td><td class="code"><pre><span class="line">&lt;script type=&quot;text/javascript&quot;&gt;</span><br><span class="line">  document.addEventListener(&quot;DOMContentLoaded&quot;, function() &#123;</span><br><span class="line">        var div1 = document.createElement(&quot;div&quot;);</span><br><span class="line">        div1.style.cssText = &quot;clear:both&quot;;</span><br><span class="line">        // 生成目录列表</span><br><span class="line">        var outline = document.createElement(&quot;div&quot;);</span><br><span class="line">        outline.setAttribute(&quot;id&quot;, &quot;outline-list&quot;);</span><br><span class="line">        outline.style.cssText = &quot;border:solid 1px #ccc; background:#eee; min-width:200px;padding:4px 10px;&quot;;</span><br><span class="line">        </span><br><span class="line">        var ele_p = document.createElement(&quot;p&quot;);</span><br><span class="line">        ele_p.style.cssText = &quot;text-align: left; margin: 0;&quot;;</span><br><span class="line">        outline.appendChild(ele_p);</span><br><span class="line">        </span><br><span class="line">        var ele_span = document.createElement(&quot;span&quot;);</span><br><span class="line">        // ele_span.style.cssText = &quot;float: left;&quot;;</span><br><span class="line">        var ele_text=document.createTextNode(&quot;目录&quot;);</span><br><span class="line">        ele_span.appendChild(ele_text);</span><br><span class="line">        </span><br><span class="line">        var ele_a = document.createElement(&quot;a&quot;);</span><br><span class="line">        ele_a.appendChild(document.createTextNode(&quot;[+]&quot;));</span><br><span class="line">        ele_a.setAttribute(&quot;href&quot;, &quot;#&quot;);</span><br><span class="line">        ele_a.setAttribute(&quot;onclick&quot;, &quot;javascript:return openct(this);&quot;);</span><br><span class="line">        ele_a.setAttribute(&quot;title&quot;, &quot;点击打开目录&quot;);</span><br><span class="line"> </span><br><span class="line">        ele_span.appendChild(ele_a);</span><br><span class="line">        ele_p.appendChild(ele_span);</span><br><span class="line"> </span><br><span class="line">        var ele_ol = document.createElement(&quot;ol&quot;);</span><br><span class="line">        ele_ol.style.cssText = &quot;display:none;margin-left:14px;padding-left:14px;line-height:160%;&quot;;</span><br><span class="line">        ele_ol.setAttribute(&quot;id&quot;, &quot;outline_ol&quot;);</span><br><span class="line">        outline.appendChild(ele_ol);</span><br><span class="line">        var div1 = document.createElement(&quot;div&quot;);</span><br><span class="line">        div1.style.cssText = &quot;clear:both&quot;;</span><br><span class="line"> </span><br><span class="line">        document.body.insertBefore(outline, document.body.childNodes[0]);</span><br><span class="line">        // 获取所有标题</span><br><span class="line">        var headers = document.querySelectorAll(&apos;h1,h2,h3,h4,h5,h6&apos;);</span><br><span class="line">        if (headers.length &lt; 2)</span><br><span class="line">          return;</span><br><span class="line"> </span><br><span class="line">        // -----</span><br><span class="line">        var old_h = 0, ol_cnt = 0;</span><br><span class="line">        // -----</span><br><span class="line">        </span><br><span class="line">        for (var i = 0; i &lt; headers.length; i++) &#123;</span><br><span class="line">          </span><br><span class="line">          var ele_ols = null;</span><br><span class="line">            // 找出它是H几，为后面的有序列表做准备</span><br><span class="line">            var header = headers[i];</span><br><span class="line">            header.setAttribute(&quot;id&quot;, &quot;t&quot; + i + header.tagName);</span><br><span class="line">            var h = parseInt(header.tagName.substr(1), 10);</span><br><span class="line">            // -----</span><br><span class="line">            if (!old_h)&#123;</span><br><span class="line">              old_h = h;</span><br><span class="line">            &#125;</span><br><span class="line">            </span><br><span class="line">            if (h &gt; old_h) &#123;</span><br><span class="line">              ele_ols = document.createElement(&quot;ol&quot;);</span><br><span class="line">              var ele_Current = ele_ol;</span><br><span class="line">              if(ele_Current &amp;&amp; ol_cnt &gt; 0)&#123;</span><br><span class="line">                var temp = ol_cnt;</span><br><span class="line">                while(temp &gt; 0)&#123;</span><br><span class="line">                  ele_Current = ele_Current.lastChild;</span><br><span class="line">                  temp--;</span><br><span class="line">                &#125;</span><br><span class="line">              &#125;</span><br><span class="line">              ele_Current.lastChild.appendChild(ele_ols);</span><br><span class="line">              ol_cnt++;</span><br><span class="line">            &#125; else if (h &lt; old_h &amp;&amp; ol_cnt &gt; 0) &#123;</span><br><span class="line">              if (h == 1) &#123;</span><br><span class="line">                while (ol_cnt &gt; 0) &#123;</span><br><span class="line">                  ol_cnt--;</span><br><span class="line">                &#125;</span><br><span class="line">              &#125; else &#123;</span><br><span class="line">                ele_ols = document.createElement(&quot;ol&quot;);</span><br><span class="line">                var ele_Current = ele_ol;</span><br><span class="line">                if(ele_Current &amp;&amp; ol_cnt &gt; 0)&#123;</span><br><span class="line">                  var temp = ol_cnt;</span><br><span class="line">                  while(temp &gt; 1)&#123;</span><br><span class="line">                    ele_Current = ele_Current.lastChild;</span><br><span class="line">                    temp--;</span><br><span class="line">                  &#125;</span><br><span class="line">                &#125;</span><br><span class="line">              ele_Current.appendChild(ele_ols);</span><br><span class="line"> </span><br><span class="line">              ol_cnt--;</span><br><span class="line">            &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            if (h == 1) &#123;</span><br><span class="line">              while (ol_cnt &gt; 0) &#123;</span><br><span class="line">                ol_cnt--;</span><br><span class="line">              &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            old_h = h;</span><br><span class="line">            // -----</span><br><span class="line">            if (ele_ols)&#123;</span><br><span class="line">              ele_li = document.createElement(&quot;li&quot;)</span><br><span class="line">              ele_ols.appendChild(ele_li);</span><br><span class="line">            &#125; else &#123;</span><br><span class="line">              ele_li = document.createElement(&quot;li&quot;)</span><br><span class="line">              ele_ol.appendChild(ele_li);</span><br><span class="line">            &#125;</span><br><span class="line">            </span><br><span class="line">            var a = document.createElement(&quot;a&quot;);</span><br><span class="line">            // 为目录项设置链接</span><br><span class="line">            a.setAttribute(&quot;href&quot;, &quot;#t&quot; + i + header.tagName);</span><br><span class="line">            // 目录项文本</span><br><span class="line">            a.innerHTML = header.textContent;</span><br><span class="line"> </span><br><span class="line">            </span><br><span class="line">            ele_li.appendChild(a);</span><br><span class="line">          &#125;</span><br><span class="line">          // -----</span><br><span class="line">          while (ol_cnt &gt; 0) &#123;</span><br><span class="line">            ol_cnt--;</span><br><span class="line">          &#125;</span><br><span class="line">          // -----</span><br><span class="line"> </span><br><span class="line">        &#125;);</span><br><span class="line">// 代开和关闭目录的函数</span><br><span class="line">function openct(e) &#123;</span><br><span class="line">  if (e.innerHTML == &apos;[+]&apos;) &#123;</span><br><span class="line">    // createTextNode</span><br><span class="line">    e.setAttribute(&apos;title&apos;, &apos;收起&apos;);</span><br><span class="line">    e.innerHTML = &apos;[-]&apos;;</span><br><span class="line">    var element = document.getElementById(&quot;outline_ol&quot;);</span><br><span class="line">    element.style.cssText = &quot;margin-left:14px;padding-left:14px;line-height:160%;&quot;;</span><br><span class="line">  &#125; else &#123;</span><br><span class="line">    e.setAttribute(&apos;title&apos;, &apos;展开&apos;);</span><br><span class="line">    e.innerHTML = &apos;[+]&apos;;</span><br><span class="line">    var element = document.getElementById(&quot;outline_ol&quot;);</span><br><span class="line">    element.style.cssText = &quot;display:none;margin-left:14px;padding-left:14px;line-height:160%;&quot;;</span><br><span class="line">  &#125;</span><br><span class="line">  e.blur();</span><br><span class="line">  return false;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure><p></p><h2 id="具体实现的步骤，和改进"><a href="#具体实现的步骤，和改进" class="headerlink" title="具体实现的步骤，和改进"></a>具体实现的步骤，和改进</h2><p>js忘光了，先用最弱智的方法来实现吧。<br>关键代码：这个代码有点脑残的。<br></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br></pre></td><td class="code"><pre><span class="line">var h1Count=1,h1Addflag=0;</span><br><span class="line">var h2Count=1,h2Addflag=0;</span><br><span class="line">var h3Count=1,h3Addflag=0;</span><br><span class="line">var h4Count=1,h4Addflag=0;</span><br><span class="line">var h5Count=1,h5Addflag=0;</span><br><span class="line">var h6Count=1,h6Addflag=0;</span><br><span class="line">$(document).ready(function()</span><br><span class="line">&#123;</span><br><span class="line">	$(&quot;h1,h2,h3,h4,h5,h6&quot;).each(function(i,item)</span><br><span class="line">	&#123;</span><br><span class="line">		//获取标签的名字,h1,还是h2</span><br><span class="line">		var tag = $(item).get(0).localName;</span><br><span class="line">		if(tag===&quot;h1&quot;)</span><br><span class="line">		&#123;</span><br><span class="line">			if(h1Addflag===1)</span><br><span class="line">			&#123;</span><br><span class="line">				h1Count++;</span><br><span class="line">			&#125;</span><br><span class="line">			h1Addflag=1;</span><br><span class="line">			//初始化子节点</span><br><span class="line">			h2Count=1;h3Count=1;h4Count=1;h5Count=1;h6Count=1;</span><br><span class="line">			//初始化子节点标志刚开始不要加1</span><br><span class="line">			h2Addflag=0;h3Addflag=0;h4Addflag=0;h5Addflag=0;h6Addflag=0;</span><br><span class="line">			console.log(&quot;捕获到标签:%s&quot;,tag);</span><br><span class="line">			var text=$(item).get(0).innerHTML;</span><br><span class="line">			$(item).get(0).innerHTML=(h1Count)+&quot; &quot;+text;</span><br><span class="line">		&#125;</span><br><span class="line">		if(tag===&quot;h2&quot;)</span><br><span class="line">		&#123;</span><br><span class="line">			if(h2Addflag===1)</span><br><span class="line">			&#123;</span><br><span class="line">				h2Count++;</span><br><span class="line">			&#125;</span><br><span class="line">			h2Addflag=1;</span><br><span class="line">			//初始化子节点</span><br><span class="line">			h3Count=1;h4Count=1;h5Count=1;h6Count=1;</span><br><span class="line">			//初始化子节点标志刚开始不要加1</span><br><span class="line">			h3Addflag=0;h4Addflag=0;h5Addflag=0;h6Addflag=0;</span><br><span class="line">			console.log(&quot;捕获到标签:%s&quot;,tag);</span><br><span class="line">			var text=$(item).get(0).innerHTML;</span><br><span class="line">			$(item).get(0).innerHTML=(h1Count)+&quot;.&quot;+(h2Count)+&quot; &quot;+text;</span><br><span class="line">		&#125;</span><br><span class="line">		if(tag===&quot;h3&quot;)</span><br><span class="line">		&#123;</span><br><span class="line">			if(h3Addflag===1)</span><br><span class="line">			&#123;</span><br><span class="line">				h3Count++;</span><br><span class="line">			&#125;</span><br><span class="line">			h3Addflag=1;</span><br><span class="line">			//初始化子节点</span><br><span class="line">			h4Count=1;h5Count=1;h6Count=1;</span><br><span class="line">			//初始化子节点标志刚开始不要加1</span><br><span class="line">			h4Addflag=0;h5Addflag=0;h6Addflag=0;</span><br><span class="line">			console.log(&quot;捕获到标签:%s&quot;,tag);</span><br><span class="line">			var text=$(item).get(0).innerHTML;</span><br><span class="line">			$(item).get(0).innerHTML=(h1Count)+&quot;.&quot;+(h2Count)+&quot;.&quot;+(h3Count)+&quot; &quot;+text;</span><br><span class="line">			</span><br><span class="line">		&#125;</span><br><span class="line">		if(tag===&quot;h4&quot;)</span><br><span class="line">		&#123;</span><br><span class="line">			if(h4Addflag===1)</span><br><span class="line">			&#123;</span><br><span class="line">				h4Count++;</span><br><span class="line">			&#125;</span><br><span class="line">			h4Addflag=1;</span><br><span class="line">			//初始化子节点</span><br><span class="line">			h5Count=1;h6Count=1;</span><br><span class="line">			//初始化子节点标志刚开始不要加1</span><br><span class="line">			h5Addflag=0;h6Addflag=0;</span><br><span class="line">			console.log(&quot;捕获到标签:%s&quot;,tag);</span><br><span class="line">			var text=$(item).get(0).innerHTML;</span><br><span class="line">			$(item).get(0).innerHTML=(h1Count)+&quot;.&quot;+(h2Count)+&quot;.&quot;+(h3Count)+&quot;.&quot;+(h4Count)+&quot; &quot;+text;</span><br><span class="line">		&#125;</span><br><span class="line">		if(tag===&quot;h5&quot;)</span><br><span class="line">		&#123;</span><br><span class="line">			if(h5Addflag===1)</span><br><span class="line">			&#123;</span><br><span class="line">				h5Count++;</span><br><span class="line">			&#125;</span><br><span class="line">			h5Addflag=1;</span><br><span class="line">			//初始化子节点</span><br><span class="line">			h6Count=1;</span><br><span class="line">			console.log(&quot;捕获到标签:%s&quot;,tag);</span><br><span class="line">			//初始化子节点标志刚开始不要加1</span><br><span class="line">			h6Addflag=0;</span><br><span class="line">			var text=$(item).get(0).innerHTML;</span><br><span class="line">			$(item).get(0).innerHTML=(h1Count)+&quot;.&quot;+(h2Count)+&quot;.&quot;+(h3Count)+&quot;.&quot;+(h4Count)+&quot;.&quot;+(h5Count)+&quot; &quot;+text;</span><br><span class="line">		&#125;</span><br><span class="line">		if(tag===&quot;h6&quot;)</span><br><span class="line">		&#123;</span><br><span class="line">			if(h6Addflag===1)</span><br><span class="line">			&#123;</span><br><span class="line">				h6Count++;</span><br><span class="line">			&#125;</span><br><span class="line">			h6Addflag=1;</span><br><span class="line">			console.log(&quot;捕获到标签:%s&quot;,tag);</span><br><span class="line">			var text=$(item).get(0).innerHTML;</span><br><span class="line">			$(item).get(0).innerHTML=(h1Count)+&quot;.&quot;+(h2Count)+&quot;.&quot;+(h3Count)+&quot;.&quot;+(h4Count)+&quot;.&quot;+(h5Count)+&quot;.&quot;+(h6Count)+&quot; &quot;+text;</span><br><span class="line">		&#125;</span><br><span class="line">		//为该标签设置id属性</span><br><span class="line">		$(item).attr(&quot;id&quot;,&quot;wow&quot;+i);</span><br><span class="line">		//添加一个超链接</span><br><span class="line">		$(&quot;#category&quot;).append(&apos;&lt;a class=&quot;new&apos;+tag+&apos;&quot; href=&quot;#wow&apos;+i+&apos;&quot;&gt;&apos;+$(this).text()+&apos;&lt;/a&gt;&lt;/br&gt;&apos;);</span><br><span class="line">		//为每一个标题超链接的class属性设置左边距</span><br><span class="line">		$(&quot;.newh1&quot;).css(&quot;margin-left&quot;,0);</span><br><span class="line">		$(&quot;.newh2&quot;).css(&quot;margin-left&quot;,20);</span><br><span class="line">		$(&quot;.newh3&quot;).css(&quot;margin-left&quot;,40);</span><br><span class="line">		$(&quot;.newh4&quot;).css(&quot;margin-left&quot;,60);</span><br><span class="line">		$(&quot;.newh5&quot;).css(&quot;margin-left&quot;,80);</span><br><span class="line">		$(&quot;.newh6&quot;).css(&quot;margin-left&quot;,100);</span><br><span class="line">	&#125;);</span><br><span class="line">	//设置class选择器为.book-body的html内容</span><br><span class="line">	$(&quot;.book-body&quot;).html($(&quot;.book-body&quot;).nextAll())</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p></p><p>上面通过6个计数器来完成的，和六个标志来完成的，js没学好，代码都很烂。不过幸运的是可以跑起来，下面来改进</p><h3 id="改进："><a href="#改进：" class="headerlink" title="改进："></a>改进：</h3><p>把上面的计数器用数组实现，然后从0开始计数，减少标志位的使用。<br>关键代码：<br></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br></pre></td><td class="code"><pre><span class="line">&lt;!--重要代码--&gt;</span><br><span class="line">//标题序号计数器</span><br><span class="line">var hCount=[0,0,0,0,0,0];</span><br><span class="line">//设置计数器</span><br><span class="line">function setHCount(number)</span><br><span class="line">&#123;</span><br><span class="line">	//当前计数器加一</span><br><span class="line">	hCount[number-1]++;</span><br><span class="line">	for(var i=number,length=hCount.length;i&lt;length;i++)</span><br><span class="line">	&#123;</span><br><span class="line">		//子目录计数器全部置零</span><br><span class="line">		hCount[i]=0;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line">//重命名目录名称</span><br><span class="line">function setHTagValue(item,number)</span><br><span class="line">&#123;</span><br><span class="line">	//获取标题名</span><br><span class="line">	var text=$(item).get(0).innerHTML;</span><br><span class="line">	//初始化空字符串</span><br><span class="line">	var before=&quot;&quot;;</span><br><span class="line">	//生成序号</span><br><span class="line">	for(var i=0,length=hCount.length;i&lt;number;i++)</span><br><span class="line">	&#123;</span><br><span class="line">		if(i&lt;number-1)</span><br><span class="line">			before+=hCount[i]+&quot;.&quot;;</span><br><span class="line">		else</span><br><span class="line">			before+=hCount[i]+&quot; &quot;;</span><br><span class="line">	&#125;</span><br><span class="line">//	$(item).get(0).innerHTML=(h1Count)+&quot;.&quot;+(h2Count)+&quot;.&quot;+(h3Count)+&quot;.&quot;+(h4Count)+&quot;.&quot;+(h5Count)+&quot;.&quot;+(h6Count)+&quot; &quot;+text;</span><br><span class="line">	//在标题前面加上序号</span><br><span class="line">	$(item).get(0).innerHTML=before+text;</span><br><span class="line">&#125;</span><br><span class="line">function renameHTag(item)</span><br><span class="line">&#123;</span><br><span class="line">	var tag = $(item).get(0).localName;</span><br><span class="line">	if(tag===&quot;h1&quot;)</span><br><span class="line">	&#123;</span><br><span class="line">		setHCount(1);</span><br><span class="line">		setHTagValue(item,1);</span><br><span class="line">	&#125;</span><br><span class="line">	if(tag===&quot;h2&quot;)</span><br><span class="line">	&#123;</span><br><span class="line">		setHCount(2);</span><br><span class="line">		setHTagValue(item,2);</span><br><span class="line">	&#125;</span><br><span class="line">	if(tag===&quot;h3&quot;)</span><br><span class="line">	&#123;</span><br><span class="line">		setHCount(3);</span><br><span class="line">		setHTagValue(item,3);</span><br><span class="line">	&#125;</span><br><span class="line">	if(tag===&quot;h4&quot;)</span><br><span class="line">	&#123;</span><br><span class="line">		setHCount(4);</span><br><span class="line">		setHTagValue(item,4);</span><br><span class="line">	&#125;</span><br><span class="line">	if(tag===&quot;h5&quot;)</span><br><span class="line">	&#123;</span><br><span class="line">		setHCount(5);</span><br><span class="line">		setHTagValue(item,5);</span><br><span class="line">	&#125;</span><br><span class="line">	if(tag===&quot;h6&quot;)</span><br><span class="line">	&#123;</span><br><span class="line">		setHCount(6);</span><br><span class="line">		setHTagValue(item,6)</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line">$(document).ready(function()</span><br><span class="line">&#123;</span><br><span class="line">	$(&quot;h1,h2,h3,h4,h5,h6&quot;).each(function(i,item)</span><br><span class="line">	&#123;</span><br><span class="line">		//给&lt;H&gt;类标签编号</span><br><span class="line">		renameHTag(item);</span><br><span class="line">		//获取标签的名字,h1,还是h2</span><br><span class="line">		var tag = $(item).get(0).localName;</span><br><span class="line"></span><br><span class="line">		//为该标签设置id属性</span><br><span class="line">		$(item).attr(&quot;id&quot;,&quot;wow&quot;+i);</span><br><span class="line">		//添加一个页内超链接,并设置class选择器</span><br><span class="line">//		$(&quot;#category&quot;).append(&apos;&lt;a class=&quot;new&apos;+tag+&apos;&quot; href=&quot;#wow&apos;+i+&apos;&quot;&gt;&apos;+$(this).text()+&apos;&lt;/a&gt;&lt;/br&gt;&apos;);</span><br><span class="line">		$(&quot;#category&quot;).append(&apos;&lt;a class=&quot;new&apos;+tag+&apos;&quot; href=&quot;#wow&apos;+i+&apos;&quot;&gt;&apos;+$(item).text()+&apos;&lt;/a&gt;&lt;/br&gt;&apos;);</span><br><span class="line">		//为每一个标题超链接的class属性设置左边距</span><br><span class="line">		$(&quot;.newh1&quot;).css(&quot;margin-left&quot;,0);</span><br><span class="line">		$(&quot;.newh2&quot;).css(&quot;margin-left&quot;,20);</span><br><span class="line">		$(&quot;.newh3&quot;).css(&quot;margin-left&quot;,40);</span><br><span class="line">		$(&quot;.newh4&quot;).css(&quot;margin-left&quot;,60);</span><br><span class="line">		$(&quot;.newh5&quot;).css(&quot;margin-left&quot;,80);</span><br><span class="line">		$(&quot;.newh6&quot;).css(&quot;margin-left&quot;,100);</span><br><span class="line">	&#125;);</span><br><span class="line">	//设置class选择器为.book-body的html内容</span><br><span class="line">	$(&quot;.book-body&quot;).html($(&quot;.book-body&quot;).nextAll())</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p></p><div id="Mark"></div><h2 id="实现在标题前面自动编号："><a href="#实现在标题前面自动编号：" class="headerlink" title="实现在标题前面自动编号："></a>实现在标题前面自动编号：</h2><p>改进：把上面的代码用函数封装好，这样阅读起来方便点，不至于一个函数很长。<br></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br></pre></td><td class="code"><pre><span class="line">&lt;script src=&quot;http://code.jquery.com/jquery-1.7.2.min.js&quot;&gt;&lt;/script&gt;</span><br><span class="line">&lt;script src=&quot;http://yandex.st/highlightjs/6.2/highlight.min.js&quot;&gt;&lt;/script&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&lt;script&gt;hljs.initHighlightingOnLoad();&lt;/script&gt;</span><br><span class="line">&lt;!--重要代码--&gt;</span><br><span class="line">&lt;script&gt;</span><br><span class="line">&lt;!--重要代码--&gt;</span><br><span class="line">&lt;!--重要代码--&gt;</span><br><span class="line">//标题序号计数器</span><br><span class="line">var hCount=[0,0,0,0,0,0];</span><br><span class="line">//设置计数器</span><br><span class="line">function setHCount(number)</span><br><span class="line">&#123;</span><br><span class="line">	//当前计数器加一</span><br><span class="line">	hCount[number-1]++;</span><br><span class="line">	for(var i=number,length=hCount.length;i&lt;length;i++)</span><br><span class="line">	&#123;</span><br><span class="line">		//子目录计数器全部置零</span><br><span class="line">		hCount[i]=0;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line">//重命名目录名称</span><br><span class="line">function setHTagValue(item,number)</span><br><span class="line">&#123;</span><br><span class="line">	//获取标题名</span><br><span class="line">	var text=$(item).get(0).innerHTML;</span><br><span class="line">	//初始化空字符串</span><br><span class="line">	var before=&quot;&quot;;</span><br><span class="line">	//生成序号</span><br><span class="line">	for(var i=0,length=hCount.length;i&lt;number;i++)</span><br><span class="line">	&#123;</span><br><span class="line">		if(i&lt;number-1)</span><br><span class="line">			before+=hCount[i]+&quot;.&quot;;</span><br><span class="line">		else</span><br><span class="line">			before+=hCount[i]+&quot; &quot;;</span><br><span class="line">	&#125;</span><br><span class="line">//	$(item).get(0).innerHTML=(h1Count)+&quot;.&quot;+(h2Count)+&quot;.&quot;+(h3Count)+&quot;.&quot;+(h4Count)+&quot;.&quot;+(h5Count)+&quot;.&quot;+(h6Count)+&quot; &quot;+text;</span><br><span class="line">	//在标题前面加上序号</span><br><span class="line">	$(item).get(0).innerHTML=before+text;</span><br><span class="line">&#125;</span><br><span class="line">function renameHTag(item)</span><br><span class="line">&#123;</span><br><span class="line">	var tag = $(item).get(0).localName;</span><br><span class="line">	if(tag===&quot;h1&quot;)</span><br><span class="line">	&#123;</span><br><span class="line">		setHCount(1);</span><br><span class="line">		console.log(&quot;捕获到标签:%s&quot;,tag);</span><br><span class="line">		setHTagValue(item,1);</span><br><span class="line">	&#125;</span><br><span class="line">	if(tag===&quot;h2&quot;)</span><br><span class="line">	&#123;</span><br><span class="line">		setHCount(2);</span><br><span class="line">		console.log(&quot;捕获到标签:%s&quot;,tag);</span><br><span class="line">		setHTagValue(item,2);</span><br><span class="line">	&#125;</span><br><span class="line">	if(tag===&quot;h3&quot;)</span><br><span class="line">	&#123;</span><br><span class="line">		setHCount(3);</span><br><span class="line">		console.log(&quot;捕获到标签:%s&quot;,tag);</span><br><span class="line">		setHTagValue(item,3);</span><br><span class="line">	&#125;</span><br><span class="line">	if(tag===&quot;h4&quot;)</span><br><span class="line">	&#123;</span><br><span class="line">		setHCount(4);</span><br><span class="line">		console.log(&quot;捕获到标签:%s&quot;,tag);</span><br><span class="line">		setHTagValue(item,4);</span><br><span class="line">	&#125;</span><br><span class="line">	if(tag===&quot;h5&quot;)</span><br><span class="line">	&#123;</span><br><span class="line">		setHCount(5);</span><br><span class="line">		console.log(&quot;捕获到标签:%s&quot;,tag);</span><br><span class="line">		setHTagValue(item,5);</span><br><span class="line">	&#125;</span><br><span class="line">	if(tag===&quot;h6&quot;)</span><br><span class="line">	&#123;</span><br><span class="line">		setHCount(6);</span><br><span class="line">		console.log(&quot;捕获到标签:%s&quot;,tag);</span><br><span class="line">		setHTagValue(item,6)</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line">$(document).ready(function()</span><br><span class="line">&#123;</span><br><span class="line">	$(&quot;h1,h2,h3,h4,h5,h6&quot;).each(function(i,item)</span><br><span class="line">	&#123;</span><br><span class="line">		//给&lt;H&gt;类标签编号</span><br><span class="line">		renameHTag(item);</span><br><span class="line">		//获取标签的名字,h1,还是h2</span><br><span class="line">		var tag = $(item).get(0).localName;</span><br><span class="line"></span><br><span class="line">		//为该标签设置id属性</span><br><span class="line">		$(item).attr(&quot;id&quot;,&quot;wow&quot;+i);</span><br><span class="line">		//添加一个页内超链接,并设置class选择器</span><br><span class="line">//		$(&quot;#category&quot;).append(&apos;&lt;a class=&quot;new&apos;+tag+&apos;&quot; href=&quot;#wow&apos;+i+&apos;&quot;&gt;&apos;+$(this).text()+&apos;&lt;/a&gt;&lt;/br&gt;&apos;);</span><br><span class="line">		$(&quot;#category&quot;).append(&apos;&lt;a class=&quot;new&apos;+tag+&apos;&quot; href=&quot;#wow&apos;+i+&apos;&quot;&gt;&apos;+$(item).text()+&apos;&lt;/a&gt;&lt;/br&gt;&apos;);</span><br><span class="line">		//为每一个标题超链接的class属性设置左边距</span><br><span class="line">		$(&quot;.newh1&quot;).css(&quot;margin-left&quot;,0);</span><br><span class="line">		$(&quot;.newh2&quot;).css(&quot;margin-left&quot;,20);</span><br><span class="line">		$(&quot;.newh3&quot;).css(&quot;margin-left&quot;,40);</span><br><span class="line">		$(&quot;.newh4&quot;).css(&quot;margin-left&quot;,60);</span><br><span class="line">		$(&quot;.newh5&quot;).css(&quot;margin-left&quot;,80);</span><br><span class="line">		$(&quot;.newh6&quot;).css(&quot;margin-left&quot;,100);</span><br><span class="line">	&#125;);</span><br><span class="line">	//设置class选择器为.book-body的html内容</span><br><span class="line">	$(&quot;.book-body&quot;).html($(&quot;.book-body&quot;).nextAll())</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style type=&quot;text/css&quot;&gt;</span><br><span class="line"></span><br><span class="line">@media (max-width: 1600px) &#123;</span><br><span class="line">    .book-body &#123;</span><br><span class="line">       padding-left:200px;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">@media (max-width: 1400px) &#123;</span><br><span class="line">    .book-body &#123;</span><br><span class="line">       padding-left:200px;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">@media (max-width: 1200px) &#123;</span><br><span class="line">    .book-body &#123;</span><br><span class="line">       padding-left:300px;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">@media (max-width: 700px) &#123;</span><br><span class="line">    .book-body &#123;</span><br><span class="line">       padding-left:0px;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">@media (min-width: 600px) &#123;</span><br><span class="line">    #category&#123;</span><br><span class="line">        position: fixed;</span><br><span class="line">        left: 20px;</span><br><span class="line">        top:0;</span><br><span class="line">        height: 100%;</span><br><span class="line">        overflow-y: scroll;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">@media (-webkit-max-device-pixel-ratio: 1) &#123;</span><br><span class="line">    ::-webkit-scrollbar-track-piece &#123;</span><br><span class="line">        background-color:#FFF</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    ::-webkit-scrollbar &#123;</span><br><span class="line">        width: 6px;</span><br><span class="line">        height: 6px</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    ::-webkit-scrollbar-thumb &#123;</span><br><span class="line">        background-color: #c2c2c2;</span><br><span class="line">        background-clip: padding-box;</span><br><span class="line">        min-height: 28px</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    ::-webkit-scrollbar-thumb:hover &#123;</span><br><span class="line">        background-color: #A0A0A0</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&lt;/style&gt;</span><br><span class="line">&lt;!--返回顶部--&gt;</span><br><span class="line">&lt;a href=&quot;javascript:scroll(0,0)&quot; style=&quot;position:fixed;float:right;right:32px;top:70%&quot;&gt;返回顶部&lt;/a&gt; </span><br><span class="line">&lt;!--目录栏，设置占用宽度为20%可以根据实际情况设置--&gt;</span><br><span class="line">&lt;div style=&quot;width:20%;&quot; id=&quot;category&quot; class=&quot;book-summary&quot;&gt;&lt;/div&gt;</span><br><span class="line">&lt;!--文章主体部分--&gt;</span><br><span class="line">&lt;div class=&quot;book-body&quot;&gt;</span><br><span class="line">&lt;/div&gt;</span><br></pre></td></tr></table></figure><p></p><h2 id="MarkdownPad2中的设置"><a href="#MarkdownPad2中的设置" class="headerlink" title="MarkdownPad2中的设置"></a>MarkdownPad2中的设置</h2><p>复制上面的代码，然后打开MarkDownPad2，<br>在MarkdownPad2中点击<code>工具--&gt;选项--&gt;高级--&gt;HTML Head编辑器</code>，然后粘贴上面代码，然后<code>保存并关闭</code>即可。<br><img src="https://i.imgur.com/pxuD8Y8.png" alt=""></p><p><img src="https://i.imgur.com/KIlcMJS.png" alt=""></p><p><img src="https://i.imgur.com/K6IXNSF.png" alt=""></p><h3 id="导出HTML"><a href="#导出HTML" class="headerlink" title="导出HTML"></a>导出HTML</h3><p>然后来导出HTML，这样才能看见侧目录。<br>选择<code>文件--&gt;导出--&gt;导出 HTML</code>,然后保存到本地即可。<br><img src="https://i.imgur.com/m1Q2OuZ.png" alt=""></p><p>然后就可看到效果了</p><p><img src="https://i.imgur.com/IjHSC6W.png" alt=""></p><p>本文链接: <a href="https://www.lansheng.net.cn/blog/728ca7fc/">MarkdownPad 导出html带侧边栏目录</a></p></div><footer class="post-footer"><div class="post-eof"></div></footer></div></article><article class="post post-type-normal" itemscope itemtype="http://schema.org/Article"><div class="post-block"><link itemprop="mainEntityOfPage" href="https://www.lansheng.net.cn/blog/59af15ef/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="name" content="蓝生"><meta itemprop="description" content=""><meta itemprop="image" content="/images/avatar.jpg"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="蓝生的博客"></span><header class="post-header"><h1 class="post-title" itemprop="name headline"><a class="post-title-link" href="/blog/59af15ef/" itemprop="url">带书签JS设置1</a></h1><div class="post-meta"><span class="post-time"><span class="post-meta-item-icon"><i class="fa fa-calendar-o"></i> </span><span class="post-meta-item-text">发表于</span> <time title="创建时间：2018-08-06 01:08:53" itemprop="dateCreated datePublished" datetime="2018-08-06T01:08:53+08:00">2018-08-06</time> <span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="fa fa-calendar-check-o"></i> </span><span class="post-meta-item-text">更新于</span> <time title="修改时间：2018-11-05 17:17:07" itemprop="dateModified" datetime="2018-11-05T17:17:07+08:00">2018-11-05</time> </span><span class="post-category"><span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="fa fa-folder-o"></i> </span><span class="post-meta-item-text">分类于</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Java/" itemprop="url" rel="index"><span itemprop="name">Java</span></a></span> ， <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Java/Java-正则表达式/" itemprop="url" rel="index"><span itemprop="name">Java 正则表达式</span></a></span> </span><span class="post-comments-count"><span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="fa fa-comment-o"></i> </span><a href="/blog/59af15ef/#comments" itemprop="discussionUrl"><span class="post-meta-item-text">评论数：</span> <span class="post-comments-count valine-comment-count" data-xid="/blog/59af15ef/" itemprop="commentCount"></span></a></span></div></header><div class="post-body" itemprop="articleBody"><p>参考：<a href="https://blog.csdn.net/zwx_lucky/article/details/53998930" target="_blank" rel="noopener">https://blog.csdn.net/zwx_lucky/article/details/53998930</a><br>原文给的代码如下：个人觉得不足的地方是没有自动编号，虽然使用了缩进但是父子标题看起来不是很明显，我在此基础加上了点代码<a href="#Mark">实现在标题前面自动编号</a>。<br></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br></pre></td><td class="code"><pre><span class="line">&lt;!--bookmark --&gt;</span><br><span class="line">&lt;script src=&quot;http://code.jquery.com/jquery-1.7.2.min.js&quot;&gt;&lt;/script&gt;</span><br><span class="line">&lt;script src=&quot;http://yandex.st/highlightjs/6.2/highlight.min.js&quot;&gt;&lt;/script&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&lt;script&gt;hljs.initHighlightingOnLoad();&lt;/script&gt;</span><br><span class="line">&lt;script type=&quot;text/javascript&quot;&gt;</span><br><span class="line"> $(document).ready(function()&#123;</span><br><span class="line"></span><br><span class="line">      $(&quot;h1,h2,h3,h4,h5,h6&quot;).each(function(i,item)&#123;</span><br><span class="line">        var tag = $(item).get(0).localName;</span><br><span class="line">        $(item).attr(&quot;id&quot;,&quot;wow&quot;+i);</span><br><span class="line">        $(&quot;#category&quot;).append(&apos;&lt;a class=&quot;new&apos;+tag+&apos;&quot; href=&quot;#wow&apos;+i+&apos;&quot;&gt;&apos;+$(this).text()+&apos;&lt;/a&gt;&lt;/br&gt;&apos;);</span><br><span class="line">        $(&quot;.newh1&quot;).css(&quot;margin-left&quot;,0);</span><br><span class="line">        $(&quot;.newh2&quot;).css(&quot;margin-left&quot;,20);</span><br><span class="line">        $(&quot;.newh3&quot;).css(&quot;margin-left&quot;,40);</span><br><span class="line">        $(&quot;.newh4&quot;).css(&quot;margin-left&quot;,60);</span><br><span class="line">        $(&quot;.newh5&quot;).css(&quot;margin-left&quot;,80);</span><br><span class="line">      	$(&quot;.newh6&quot;).css(&quot;margin-left&quot;,100);</span><br><span class="line">      &#125;);</span><br><span class="line"></span><br><span class="line">       $(&quot;.book-body&quot;).html($(&quot;.book-body&quot;).nextAll())</span><br><span class="line"> &#125;);</span><br><span class="line">&lt;/script&gt;</span><br><span class="line">&lt;style type=&quot;text/css&quot;&gt;</span><br><span class="line"></span><br><span class="line">@media (max-width: 1600px) &#123;</span><br><span class="line">    .book-body &#123;</span><br><span class="line">       padding-left:200px;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">@media (max-width: 1400px) &#123;</span><br><span class="line">    .book-body &#123;</span><br><span class="line">       padding-left:200px;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">@media (max-width: 1200px) &#123;</span><br><span class="line">    .book-body &#123;</span><br><span class="line">       padding-left:300px;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">@media (max-width: 700px) &#123;</span><br><span class="line">    .book-body &#123;</span><br><span class="line">       padding-left:0px;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">@media (min-width: 600px) &#123;</span><br><span class="line">    #category&#123;</span><br><span class="line">        position: fixed;</span><br><span class="line">        left: 20px;</span><br><span class="line">        top:0;</span><br><span class="line">        height: 100%;</span><br><span class="line">        overflow-y: scroll;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">@media (-webkit-max-device-pixel-ratio: 1) &#123;</span><br><span class="line">    ::-webkit-scrollbar-track-piece &#123;</span><br><span class="line">        background-color:#FFF</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    ::-webkit-scrollbar &#123;</span><br><span class="line">        width: 6px;</span><br><span class="line">        height: 6px</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    ::-webkit-scrollbar-thumb &#123;</span><br><span class="line">        background-color: #c2c2c2;</span><br><span class="line">        background-clip: padding-box;</span><br><span class="line">        min-height: 28px</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    ::-webkit-scrollbar-thumb:hover &#123;</span><br><span class="line">        background-color: #A0A0A0</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&lt;/style&gt;</span><br><span class="line">&lt;a href=&quot;javascript:scroll(0,0)&quot; style=&quot;position:fixed;float:right;right:32px;top:70%&quot;&gt;返回顶部&lt;/a&gt; </span><br><span class="line">&lt;div style=&quot;width:20%;&quot; id=&quot;category&quot; class=&quot;book-summary&quot;&gt;&lt;/div&gt;</span><br><span class="line">&lt;div class=&quot;book-body&quot;&gt;</span><br><span class="line">&lt;/div&gt;</span><br></pre></td></tr></table></figure><p></p><p>实现方式2：缺点是书签在顶部，不好快速跳转<br></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br></pre></td><td class="code"><pre><span class="line">&lt;script type=&quot;text/javascript&quot;&gt;</span><br><span class="line">  document.addEventListener(&quot;DOMContentLoaded&quot;, function() &#123;</span><br><span class="line">        var div1 = document.createElement(&quot;div&quot;);</span><br><span class="line">        div1.style.cssText = &quot;clear:both&quot;;</span><br><span class="line">        // 生成目录列表</span><br><span class="line">        var outline = document.createElement(&quot;div&quot;);</span><br><span class="line">        outline.setAttribute(&quot;id&quot;, &quot;outline-list&quot;);</span><br><span class="line">        outline.style.cssText = &quot;border:solid 1px #ccc; background:#eee; min-width:200px;padding:4px 10px;&quot;;</span><br><span class="line">        </span><br><span class="line">        var ele_p = document.createElement(&quot;p&quot;);</span><br><span class="line">        ele_p.style.cssText = &quot;text-align: left; margin: 0;&quot;;</span><br><span class="line">        outline.appendChild(ele_p);</span><br><span class="line">        </span><br><span class="line">        var ele_span = document.createElement(&quot;span&quot;);</span><br><span class="line">        // ele_span.style.cssText = &quot;float: left;&quot;;</span><br><span class="line">        var ele_text=document.createTextNode(&quot;目录&quot;);</span><br><span class="line">        ele_span.appendChild(ele_text);</span><br><span class="line">        </span><br><span class="line">        var ele_a = document.createElement(&quot;a&quot;);</span><br><span class="line">        ele_a.appendChild(document.createTextNode(&quot;[+]&quot;));</span><br><span class="line">        ele_a.setAttribute(&quot;href&quot;, &quot;#&quot;);</span><br><span class="line">        ele_a.setAttribute(&quot;onclick&quot;, &quot;javascript:return openct(this);&quot;);</span><br><span class="line">        ele_a.setAttribute(&quot;title&quot;, &quot;点击打开目录&quot;);</span><br><span class="line"> </span><br><span class="line">        ele_span.appendChild(ele_a);</span><br><span class="line">        ele_p.appendChild(ele_span);</span><br><span class="line"> </span><br><span class="line">        var ele_ol = document.createElement(&quot;ol&quot;);</span><br><span class="line">        ele_ol.style.cssText = &quot;display:none;margin-left:14px;padding-left:14px;line-height:160%;&quot;;</span><br><span class="line">        ele_ol.setAttribute(&quot;id&quot;, &quot;outline_ol&quot;);</span><br><span class="line">        outline.appendChild(ele_ol);</span><br><span class="line">        var div1 = document.createElement(&quot;div&quot;);</span><br><span class="line">        div1.style.cssText = &quot;clear:both&quot;;</span><br><span class="line"> </span><br><span class="line">        document.body.insertBefore(outline, document.body.childNodes[0]);</span><br><span class="line">        // 获取所有标题</span><br><span class="line">        var headers = document.querySelectorAll(&apos;h1,h2,h3,h4,h5,h6&apos;);</span><br><span class="line">        if (headers.length &lt; 2)</span><br><span class="line">          return;</span><br><span class="line"> </span><br><span class="line">        // -----</span><br><span class="line">        var old_h = 0, ol_cnt = 0;</span><br><span class="line">        // -----</span><br><span class="line">        </span><br><span class="line">        for (var i = 0; i &lt; headers.length; i++) &#123;</span><br><span class="line">          </span><br><span class="line">          var ele_ols = null;</span><br><span class="line">            // 找出它是H几，为后面的有序列表做准备</span><br><span class="line">            var header = headers[i];</span><br><span class="line">            header.setAttribute(&quot;id&quot;, &quot;t&quot; + i + header.tagName);</span><br><span class="line">            var h = parseInt(header.tagName.substr(1), 10);</span><br><span class="line">            // -----</span><br><span class="line">            if (!old_h)&#123;</span><br><span class="line">              old_h = h;</span><br><span class="line">            &#125;</span><br><span class="line">            </span><br><span class="line">            if (h &gt; old_h) &#123;</span><br><span class="line">              ele_ols = document.createElement(&quot;ol&quot;);</span><br><span class="line">              var ele_Current = ele_ol;</span><br><span class="line">              if(ele_Current &amp;&amp; ol_cnt &gt; 0)&#123;</span><br><span class="line">                var temp = ol_cnt;</span><br><span class="line">                while(temp &gt; 0)&#123;</span><br><span class="line">                  ele_Current = ele_Current.lastChild;</span><br><span class="line">                  temp--;</span><br><span class="line">                &#125;</span><br><span class="line">              &#125;</span><br><span class="line">              ele_Current.lastChild.appendChild(ele_ols);</span><br><span class="line">              ol_cnt++;</span><br><span class="line">            &#125; else if (h &lt; old_h &amp;&amp; ol_cnt &gt; 0) &#123;</span><br><span class="line">              if (h == 1) &#123;</span><br><span class="line">                while (ol_cnt &gt; 0) &#123;</span><br><span class="line">                  ol_cnt--;</span><br><span class="line">                &#125;</span><br><span class="line">              &#125; else &#123;</span><br><span class="line">                ele_ols = document.createElement(&quot;ol&quot;);</span><br><span class="line">                var ele_Current = ele_ol;</span><br><span class="line">                if(ele_Current &amp;&amp; ol_cnt &gt; 0)&#123;</span><br><span class="line">                  var temp = ol_cnt;</span><br><span class="line">                  while(temp &gt; 1)&#123;</span><br><span class="line">                    ele_Current = ele_Current.lastChild;</span><br><span class="line">                    temp--;</span><br><span class="line">                  &#125;</span><br><span class="line">                &#125;</span><br><span class="line">              ele_Current.appendChild(ele_ols);</span><br><span class="line"> </span><br><span class="line">              ol_cnt--;</span><br><span class="line">            &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            if (h == 1) &#123;</span><br><span class="line">              while (ol_cnt &gt; 0) &#123;</span><br><span class="line">                ol_cnt--;</span><br><span class="line">              &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            old_h = h;</span><br><span class="line">            // -----</span><br><span class="line">            if (ele_ols)&#123;</span><br><span class="line">              ele_li = document.createElement(&quot;li&quot;)</span><br><span class="line">              ele_ols.appendChild(ele_li);</span><br><span class="line">            &#125; else &#123;</span><br><span class="line">              ele_li = document.createElement(&quot;li&quot;)</span><br><span class="line">              ele_ol.appendChild(ele_li);</span><br><span class="line">            &#125;</span><br><span class="line">            </span><br><span class="line">            var a = document.createElement(&quot;a&quot;);</span><br><span class="line">            // 为目录项设置链接</span><br><span class="line">            a.setAttribute(&quot;href&quot;, &quot;#t&quot; + i + header.tagName);</span><br><span class="line">            // 目录项文本</span><br><span class="line">            a.innerHTML = header.textContent;</span><br><span class="line"> </span><br><span class="line">            </span><br><span class="line">            ele_li.appendChild(a);</span><br><span class="line">          &#125;</span><br><span class="line">          // -----</span><br><span class="line">          while (ol_cnt &gt; 0) &#123;</span><br><span class="line">            ol_cnt--;</span><br><span class="line">          &#125;</span><br><span class="line">          // -----</span><br><span class="line"> </span><br><span class="line">        &#125;);</span><br><span class="line">// 代开和关闭目录的函数</span><br><span class="line">function openct(e) &#123;</span><br><span class="line">  if (e.innerHTML == &apos;[+]&apos;) &#123;</span><br><span class="line">    // createTextNode</span><br><span class="line">    e.setAttribute(&apos;title&apos;, &apos;收起&apos;);</span><br><span class="line">    e.innerHTML = &apos;[-]&apos;;</span><br><span class="line">    var element = document.getElementById(&quot;outline_ol&quot;);</span><br><span class="line">    element.style.cssText = &quot;margin-left:14px;padding-left:14px;line-height:160%;&quot;;</span><br><span class="line">  &#125; else &#123;</span><br><span class="line">    e.setAttribute(&apos;title&apos;, &apos;展开&apos;);</span><br><span class="line">    e.innerHTML = &apos;[+]&apos;;</span><br><span class="line">    var element = document.getElementById(&quot;outline_ol&quot;);</span><br><span class="line">    element.style.cssText = &quot;display:none;margin-left:14px;padding-left:14px;line-height:160%;&quot;;</span><br><span class="line">  &#125;</span><br><span class="line">  e.blur();</span><br><span class="line">  return false;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure><p></p><h2 id="具体实现的步骤，和改进"><a href="#具体实现的步骤，和改进" class="headerlink" title="具体实现的步骤，和改进"></a>具体实现的步骤，和改进</h2><p>js忘光了，先用最弱智的方法来实现吧。<br>关键代码：这个代码有点脑残的。<br></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br></pre></td><td class="code"><pre><span class="line">var h1Count=1,h1Addflag=0;</span><br><span class="line">var h2Count=1,h2Addflag=0;</span><br><span class="line">var h3Count=1,h3Addflag=0;</span><br><span class="line">var h4Count=1,h4Addflag=0;</span><br><span class="line">var h5Count=1,h5Addflag=0;</span><br><span class="line">var h6Count=1,h6Addflag=0;</span><br><span class="line">$(document).ready(function()</span><br><span class="line">&#123;</span><br><span class="line">	$(&quot;h1,h2,h3,h4,h5,h6&quot;).each(function(i,item)</span><br><span class="line">	&#123;</span><br><span class="line">		//获取标签的名字,h1,还是h2</span><br><span class="line">		var tag = $(item).get(0).localName;</span><br><span class="line">		if(tag===&quot;h1&quot;)</span><br><span class="line">		&#123;</span><br><span class="line">			if(h1Addflag===1)</span><br><span class="line">			&#123;</span><br><span class="line">				h1Count++;</span><br><span class="line">			&#125;</span><br><span class="line">			h1Addflag=1;</span><br><span class="line">			//初始化子节点</span><br><span class="line">			h2Count=1;h3Count=1;h4Count=1;h5Count=1;h6Count=1;</span><br><span class="line">			//初始化子节点标志刚开始不要加1</span><br><span class="line">			h2Addflag=0;h3Addflag=0;h4Addflag=0;h5Addflag=0;h6Addflag=0;</span><br><span class="line">			console.log(&quot;捕获到标签:%s&quot;,tag);</span><br><span class="line">			var text=$(item).get(0).innerHTML;</span><br><span class="line">			$(item).get(0).innerHTML=(h1Count)+&quot; &quot;+text;</span><br><span class="line">		&#125;</span><br><span class="line">		if(tag===&quot;h2&quot;)</span><br><span class="line">		&#123;</span><br><span class="line">			if(h2Addflag===1)</span><br><span class="line">			&#123;</span><br><span class="line">				h2Count++;</span><br><span class="line">			&#125;</span><br><span class="line">			h2Addflag=1;</span><br><span class="line">			//初始化子节点</span><br><span class="line">			h3Count=1;h4Count=1;h5Count=1;h6Count=1;</span><br><span class="line">			//初始化子节点标志刚开始不要加1</span><br><span class="line">			h3Addflag=0;h4Addflag=0;h5Addflag=0;h6Addflag=0;</span><br><span class="line">			console.log(&quot;捕获到标签:%s&quot;,tag);</span><br><span class="line">			var text=$(item).get(0).innerHTML;</span><br><span class="line">			$(item).get(0).innerHTML=(h1Count)+&quot;.&quot;+(h2Count)+&quot; &quot;+text;</span><br><span class="line">		&#125;</span><br><span class="line">		if(tag===&quot;h3&quot;)</span><br><span class="line">		&#123;</span><br><span class="line">			if(h3Addflag===1)</span><br><span class="line">			&#123;</span><br><span class="line">				h3Count++;</span><br><span class="line">			&#125;</span><br><span class="line">			h3Addflag=1;</span><br><span class="line">			//初始化子节点</span><br><span class="line">			h4Count=1;h5Count=1;h6Count=1;</span><br><span class="line">			//初始化子节点标志刚开始不要加1</span><br><span class="line">			h4Addflag=0;h5Addflag=0;h6Addflag=0;</span><br><span class="line">			console.log(&quot;捕获到标签:%s&quot;,tag);</span><br><span class="line">			var text=$(item).get(0).innerHTML;</span><br><span class="line">			$(item).get(0).innerHTML=(h1Count)+&quot;.&quot;+(h2Count)+&quot;.&quot;+(h3Count)+&quot; &quot;+text;</span><br><span class="line">			</span><br><span class="line">		&#125;</span><br><span class="line">		if(tag===&quot;h4&quot;)</span><br><span class="line">		&#123;</span><br><span class="line">			if(h4Addflag===1)</span><br><span class="line">			&#123;</span><br><span class="line">				h4Count++;</span><br><span class="line">			&#125;</span><br><span class="line">			h4Addflag=1;</span><br><span class="line">			//初始化子节点</span><br><span class="line">			h5Count=1;h6Count=1;</span><br><span class="line">			//初始化子节点标志刚开始不要加1</span><br><span class="line">			h5Addflag=0;h6Addflag=0;</span><br><span class="line">			console.log(&quot;捕获到标签:%s&quot;,tag);</span><br><span class="line">			var text=$(item).get(0).innerHTML;</span><br><span class="line">			$(item).get(0).innerHTML=(h1Count)+&quot;.&quot;+(h2Count)+&quot;.&quot;+(h3Count)+&quot;.&quot;+(h4Count)+&quot; &quot;+text;</span><br><span class="line">		&#125;</span><br><span class="line">		if(tag===&quot;h5&quot;)</span><br><span class="line">		&#123;</span><br><span class="line">			if(h5Addflag===1)</span><br><span class="line">			&#123;</span><br><span class="line">				h5Count++;</span><br><span class="line">			&#125;</span><br><span class="line">			h5Addflag=1;</span><br><span class="line">			//初始化子节点</span><br><span class="line">			h6Count=1;</span><br><span class="line">			console.log(&quot;捕获到标签:%s&quot;,tag);</span><br><span class="line">			//初始化子节点标志刚开始不要加1</span><br><span class="line">			h6Addflag=0;</span><br><span class="line">			var text=$(item).get(0).innerHTML;</span><br><span class="line">			$(item).get(0).innerHTML=(h1Count)+&quot;.&quot;+(h2Count)+&quot;.&quot;+(h3Count)+&quot;.&quot;+(h4Count)+&quot;.&quot;+(h5Count)+&quot; &quot;+text;</span><br><span class="line">		&#125;</span><br><span class="line">		if(tag===&quot;h6&quot;)</span><br><span class="line">		&#123;</span><br><span class="line">			if(h6Addflag===1)</span><br><span class="line">			&#123;</span><br><span class="line">				h6Count++;</span><br><span class="line">			&#125;</span><br><span class="line">			h6Addflag=1;</span><br><span class="line">			console.log(&quot;捕获到标签:%s&quot;,tag);</span><br><span class="line">			var text=$(item).get(0).innerHTML;</span><br><span class="line">			$(item).get(0).innerHTML=(h1Count)+&quot;.&quot;+(h2Count)+&quot;.&quot;+(h3Count)+&quot;.&quot;+(h4Count)+&quot;.&quot;+(h5Count)+&quot;.&quot;+(h6Count)+&quot; &quot;+text;</span><br><span class="line">		&#125;</span><br><span class="line">		//为该标签设置id属性</span><br><span class="line">		$(item).attr(&quot;id&quot;,&quot;wow&quot;+i);</span><br><span class="line">		//添加一个超链接</span><br><span class="line">		$(&quot;#category&quot;).append(&apos;&lt;a class=&quot;new&apos;+tag+&apos;&quot; href=&quot;#wow&apos;+i+&apos;&quot;&gt;&apos;+$(this).text()+&apos;&lt;/a&gt;&lt;/br&gt;&apos;);</span><br><span class="line">		//为每一个标题超链接的class属性设置左边距</span><br><span class="line">		$(&quot;.newh1&quot;).css(&quot;margin-left&quot;,0);</span><br><span class="line">		$(&quot;.newh2&quot;).css(&quot;margin-left&quot;,20);</span><br><span class="line">		$(&quot;.newh3&quot;).css(&quot;margin-left&quot;,40);</span><br><span class="line">		$(&quot;.newh4&quot;).css(&quot;margin-left&quot;,60);</span><br><span class="line">		$(&quot;.newh5&quot;).css(&quot;margin-left&quot;,80);</span><br><span class="line">		$(&quot;.newh6&quot;).css(&quot;margin-left&quot;,100);</span><br><span class="line">	&#125;);</span><br><span class="line">	//设置class选择器为.book-body的html内容</span><br><span class="line">	$(&quot;.book-body&quot;).html($(&quot;.book-body&quot;).nextAll())</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p></p><p>上面通过6个计数器来完成的，和六个标志来完成的，js没学好，代码都很烂。不过幸运的是可以跑起来，下面来改进</p><h3 id="改进："><a href="#改进：" class="headerlink" title="改进："></a>改进：</h3><p>把上面的计数器用数组实现，然后从0开始计数，减少标志位的使用。<br>关键代码：<br></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br></pre></td><td class="code"><pre><span class="line">&lt;!--重要代码--&gt;</span><br><span class="line">//标题序号计数器</span><br><span class="line">var hCount=[0,0,0,0,0,0];</span><br><span class="line">//设置计数器</span><br><span class="line">function setHCount(number)</span><br><span class="line">&#123;</span><br><span class="line">	//当前计数器加一</span><br><span class="line">	hCount[number-1]++;</span><br><span class="line">	for(var i=number,length=hCount.length;i&lt;length;i++)</span><br><span class="line">	&#123;</span><br><span class="line">		//子目录计数器全部置零</span><br><span class="line">		hCount[i]=0;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line">//重命名目录名称</span><br><span class="line">function setHTagValue(item,number)</span><br><span class="line">&#123;</span><br><span class="line">	//获取标题名</span><br><span class="line">	var text=$(item).get(0).innerHTML;</span><br><span class="line">	//初始化空字符串</span><br><span class="line">	var before=&quot;&quot;;</span><br><span class="line">	//生成序号</span><br><span class="line">	for(var i=0,length=hCount.length;i&lt;number;i++)</span><br><span class="line">	&#123;</span><br><span class="line">		if(i&lt;number-1)</span><br><span class="line">			before+=hCount[i]+&quot;.&quot;;</span><br><span class="line">		else</span><br><span class="line">			before+=hCount[i]+&quot; &quot;;</span><br><span class="line">	&#125;</span><br><span class="line">//	$(item).get(0).innerHTML=(h1Count)+&quot;.&quot;+(h2Count)+&quot;.&quot;+(h3Count)+&quot;.&quot;+(h4Count)+&quot;.&quot;+(h5Count)+&quot;.&quot;+(h6Count)+&quot; &quot;+text;</span><br><span class="line">	//在标题前面加上序号</span><br><span class="line">	$(item).get(0).innerHTML=before+text;</span><br><span class="line">&#125;</span><br><span class="line">function renameHTag(item)</span><br><span class="line">&#123;</span><br><span class="line">	var tag = $(item).get(0).localName;</span><br><span class="line">	if(tag===&quot;h1&quot;)</span><br><span class="line">	&#123;</span><br><span class="line">		setHCount(1);</span><br><span class="line">		setHTagValue(item,1);</span><br><span class="line">	&#125;</span><br><span class="line">	if(tag===&quot;h2&quot;)</span><br><span class="line">	&#123;</span><br><span class="line">		setHCount(2);</span><br><span class="line">		setHTagValue(item,2);</span><br><span class="line">	&#125;</span><br><span class="line">	if(tag===&quot;h3&quot;)</span><br><span class="line">	&#123;</span><br><span class="line">		setHCount(3);</span><br><span class="line">		setHTagValue(item,3);</span><br><span class="line">	&#125;</span><br><span class="line">	if(tag===&quot;h4&quot;)</span><br><span class="line">	&#123;</span><br><span class="line">		setHCount(4);</span><br><span class="line">		setHTagValue(item,4);</span><br><span class="line">	&#125;</span><br><span class="line">	if(tag===&quot;h5&quot;)</span><br><span class="line">	&#123;</span><br><span class="line">		setHCount(5);</span><br><span class="line">		setHTagValue(item,5);</span><br><span class="line">	&#125;</span><br><span class="line">	if(tag===&quot;h6&quot;)</span><br><span class="line">	&#123;</span><br><span class="line">		setHCount(6);</span><br><span class="line">		setHTagValue(item,6)</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line">$(document).ready(function()</span><br><span class="line">&#123;</span><br><span class="line">	$(&quot;h1,h2,h3,h4,h5,h6&quot;).each(function(i,item)</span><br><span class="line">	&#123;</span><br><span class="line">		//给&lt;H&gt;类标签编号</span><br><span class="line">		renameHTag(item);</span><br><span class="line">		//获取标签的名字,h1,还是h2</span><br><span class="line">		var tag = $(item).get(0).localName;</span><br><span class="line"></span><br><span class="line">		//为该标签设置id属性</span><br><span class="line">		$(item).attr(&quot;id&quot;,&quot;wow&quot;+i);</span><br><span class="line">		//添加一个页内超链接,并设置class选择器</span><br><span class="line">//		$(&quot;#category&quot;).append(&apos;&lt;a class=&quot;new&apos;+tag+&apos;&quot; href=&quot;#wow&apos;+i+&apos;&quot;&gt;&apos;+$(this).text()+&apos;&lt;/a&gt;&lt;/br&gt;&apos;);</span><br><span class="line">		$(&quot;#category&quot;).append(&apos;&lt;a class=&quot;new&apos;+tag+&apos;&quot; href=&quot;#wow&apos;+i+&apos;&quot;&gt;&apos;+$(item).text()+&apos;&lt;/a&gt;&lt;/br&gt;&apos;);</span><br><span class="line">		//为每一个标题超链接的class属性设置左边距</span><br><span class="line">		$(&quot;.newh1&quot;).css(&quot;margin-left&quot;,0);</span><br><span class="line">		$(&quot;.newh2&quot;).css(&quot;margin-left&quot;,20);</span><br><span class="line">		$(&quot;.newh3&quot;).css(&quot;margin-left&quot;,40);</span><br><span class="line">		$(&quot;.newh4&quot;).css(&quot;margin-left&quot;,60);</span><br><span class="line">		$(&quot;.newh5&quot;).css(&quot;margin-left&quot;,80);</span><br><span class="line">		$(&quot;.newh6&quot;).css(&quot;margin-left&quot;,100);</span><br><span class="line">	&#125;);</span><br><span class="line">	//设置class选择器为.book-body的html内容</span><br><span class="line">	$(&quot;.book-body&quot;).html($(&quot;.book-body&quot;).nextAll())</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p></p><div id="Mark"></div><h2 id="实现在标题前面自动编号："><a href="#实现在标题前面自动编号：" class="headerlink" title="实现在标题前面自动编号："></a>实现在标题前面自动编号：</h2><p>改进：把上面的代码用函数封装好，这样阅读起来方便点，不至于一个函数很长。<br></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br></pre></td><td class="code"><pre><span class="line">&lt;script src=&quot;http://code.jquery.com/jquery-1.7.2.min.js&quot;&gt;&lt;/script&gt;</span><br><span class="line">&lt;script src=&quot;http://yandex.st/highlightjs/6.2/highlight.min.js&quot;&gt;&lt;/script&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&lt;script&gt;hljs.initHighlightingOnLoad();&lt;/script&gt;</span><br><span class="line">&lt;!--重要代码--&gt;</span><br><span class="line">&lt;script&gt;</span><br><span class="line">&lt;!--重要代码--&gt;</span><br><span class="line">&lt;!--重要代码--&gt;</span><br><span class="line">//标题序号计数器</span><br><span class="line">var hCount=[0,0,0,0,0,0];</span><br><span class="line">//设置计数器</span><br><span class="line">function setHCount(number)</span><br><span class="line">&#123;</span><br><span class="line">	//当前计数器加一</span><br><span class="line">	hCount[number-1]++;</span><br><span class="line">	for(var i=number,length=hCount.length;i&lt;length;i++)</span><br><span class="line">	&#123;</span><br><span class="line">		//子目录计数器全部置零</span><br><span class="line">		hCount[i]=0;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line">//重命名目录名称</span><br><span class="line">function setHTagValue(item,number)</span><br><span class="line">&#123;</span><br><span class="line">	//获取标题名</span><br><span class="line">	var text=$(item).get(0).innerHTML;</span><br><span class="line">	//初始化空字符串</span><br><span class="line">	var before=&quot;&quot;;</span><br><span class="line">	//生成序号</span><br><span class="line">	for(var i=0,length=hCount.length;i&lt;number;i++)</span><br><span class="line">	&#123;</span><br><span class="line">		if(i&lt;number-1)</span><br><span class="line">			before+=hCount[i]+&quot;.&quot;;</span><br><span class="line">		else</span><br><span class="line">			before+=hCount[i]+&quot; &quot;;</span><br><span class="line">	&#125;</span><br><span class="line">//	$(item).get(0).innerHTML=(h1Count)+&quot;.&quot;+(h2Count)+&quot;.&quot;+(h3Count)+&quot;.&quot;+(h4Count)+&quot;.&quot;+(h5Count)+&quot;.&quot;+(h6Count)+&quot; &quot;+text;</span><br><span class="line">	//在标题前面加上序号</span><br><span class="line">	$(item).get(0).innerHTML=before+text;</span><br><span class="line">&#125;</span><br><span class="line">function renameHTag(item)</span><br><span class="line">&#123;</span><br><span class="line">	var tag = $(item).get(0).localName;</span><br><span class="line">	if(tag===&quot;h1&quot;)</span><br><span class="line">	&#123;</span><br><span class="line">		setHCount(1);</span><br><span class="line">		console.log(&quot;捕获到标签:%s&quot;,tag);</span><br><span class="line">		setHTagValue(item,1);</span><br><span class="line">	&#125;</span><br><span class="line">	if(tag===&quot;h2&quot;)</span><br><span class="line">	&#123;</span><br><span class="line">		setHCount(2);</span><br><span class="line">		console.log(&quot;捕获到标签:%s&quot;,tag);</span><br><span class="line">		setHTagValue(item,2);</span><br><span class="line">	&#125;</span><br><span class="line">	if(tag===&quot;h3&quot;)</span><br><span class="line">	&#123;</span><br><span class="line">		setHCount(3);</span><br><span class="line">		console.log(&quot;捕获到标签:%s&quot;,tag);</span><br><span class="line">		setHTagValue(item,3);</span><br><span class="line">	&#125;</span><br><span class="line">	if(tag===&quot;h4&quot;)</span><br><span class="line">	&#123;</span><br><span class="line">		setHCount(4);</span><br><span class="line">		console.log(&quot;捕获到标签:%s&quot;,tag);</span><br><span class="line">		setHTagValue(item,4);</span><br><span class="line">	&#125;</span><br><span class="line">	if(tag===&quot;h5&quot;)</span><br><span class="line">	&#123;</span><br><span class="line">		setHCount(5);</span><br><span class="line">		console.log(&quot;捕获到标签:%s&quot;,tag);</span><br><span class="line">		setHTagValue(item,5);</span><br><span class="line">	&#125;</span><br><span class="line">	if(tag===&quot;h6&quot;)</span><br><span class="line">	&#123;</span><br><span class="line">		setHCount(6);</span><br><span class="line">		console.log(&quot;捕获到标签:%s&quot;,tag);</span><br><span class="line">		setHTagValue(item,6)</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line">$(document).ready(function()</span><br><span class="line">&#123;</span><br><span class="line">	$(&quot;h1,h2,h3,h4,h5,h6&quot;).each(function(i,item)</span><br><span class="line">	&#123;</span><br><span class="line">		//给&lt;H&gt;类标签编号</span><br><span class="line">		renameHTag(item);</span><br><span class="line">		//获取标签的名字,h1,还是h2</span><br><span class="line">		var tag = $(item).get(0).localName;</span><br><span class="line"></span><br><span class="line">		//为该标签设置id属性</span><br><span class="line">		$(item).attr(&quot;id&quot;,&quot;wow&quot;+i);</span><br><span class="line">		//添加一个页内超链接,并设置class选择器</span><br><span class="line">//		$(&quot;#category&quot;).append(&apos;&lt;a class=&quot;new&apos;+tag+&apos;&quot; href=&quot;#wow&apos;+i+&apos;&quot;&gt;&apos;+$(this).text()+&apos;&lt;/a&gt;&lt;/br&gt;&apos;);</span><br><span class="line">		$(&quot;#category&quot;).append(&apos;&lt;a class=&quot;new&apos;+tag+&apos;&quot; href=&quot;#wow&apos;+i+&apos;&quot;&gt;&apos;+$(item).text()+&apos;&lt;/a&gt;&lt;/br&gt;&apos;);</span><br><span class="line">		//为每一个标题超链接的class属性设置左边距</span><br><span class="line">		$(&quot;.newh1&quot;).css(&quot;margin-left&quot;,0);</span><br><span class="line">		$(&quot;.newh2&quot;).css(&quot;margin-left&quot;,20);</span><br><span class="line">		$(&quot;.newh3&quot;).css(&quot;margin-left&quot;,40);</span><br><span class="line">		$(&quot;.newh4&quot;).css(&quot;margin-left&quot;,60);</span><br><span class="line">		$(&quot;.newh5&quot;).css(&quot;margin-left&quot;,80);</span><br><span class="line">		$(&quot;.newh6&quot;).css(&quot;margin-left&quot;,100);</span><br><span class="line">	&#125;);</span><br><span class="line">	//设置class选择器为.book-body的html内容</span><br><span class="line">	$(&quot;.book-body&quot;).html($(&quot;.book-body&quot;).nextAll())</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style type=&quot;text/css&quot;&gt;</span><br><span class="line"></span><br><span class="line">@media (max-width: 1600px) &#123;</span><br><span class="line">    .book-body &#123;</span><br><span class="line">       padding-left:200px;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">@media (max-width: 1400px) &#123;</span><br><span class="line">    .book-body &#123;</span><br><span class="line">       padding-left:200px;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">@media (max-width: 1200px) &#123;</span><br><span class="line">    .book-body &#123;</span><br><span class="line">       padding-left:300px;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">@media (max-width: 700px) &#123;</span><br><span class="line">    .book-body &#123;</span><br><span class="line">       padding-left:0px;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">@media (min-width: 600px) &#123;</span><br><span class="line">    #category&#123;</span><br><span class="line">        position: fixed;</span><br><span class="line">        left: 20px;</span><br><span class="line">        top:0;</span><br><span class="line">        height: 100%;</span><br><span class="line">        overflow-y: scroll;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">@media (-webkit-max-device-pixel-ratio: 1) &#123;</span><br><span class="line">    ::-webkit-scrollbar-track-piece &#123;</span><br><span class="line">        background-color:#FFF</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    ::-webkit-scrollbar &#123;</span><br><span class="line">        width: 6px;</span><br><span class="line">        height: 6px</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    ::-webkit-scrollbar-thumb &#123;</span><br><span class="line">        background-color: #c2c2c2;</span><br><span class="line">        background-clip: padding-box;</span><br><span class="line">        min-height: 28px</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    ::-webkit-scrollbar-thumb:hover &#123;</span><br><span class="line">        background-color: #A0A0A0</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&lt;/style&gt;</span><br><span class="line">&lt;!--返回顶部--&gt;</span><br><span class="line">&lt;a href=&quot;javascript:scroll(0,0)&quot; style=&quot;position:fixed;float:right;right:32px;top:70%&quot;&gt;返回顶部&lt;/a&gt; </span><br><span class="line">&lt;!--目录栏，设置占用宽度为20%可以根据实际情况设置--&gt;</span><br><span class="line">&lt;div style=&quot;width:20%;&quot; id=&quot;category&quot; class=&quot;book-summary&quot;&gt;&lt;/div&gt;</span><br><span class="line">&lt;!--文章主体部分--&gt;</span><br><span class="line">&lt;div class=&quot;book-body&quot;&gt;</span><br><span class="line">&lt;/div&gt;</span><br></pre></td></tr></table></figure><p></p><h2 id="MarkdownPad2中的设置"><a href="#MarkdownPad2中的设置" class="headerlink" title="MarkdownPad2中的设置"></a>MarkdownPad2中的设置</h2><p>复制上面的代码，然后打开MarkDownPad2，<br>在MarkdownPad2中点击<code>工具--&gt;选项--&gt;高级--&gt;HTML Head编辑器</code>，然后粘贴上面代码，然后<code>保存并关闭</code>即可。<br><img src="https://i.imgur.com/pxuD8Y8.png" alt=""></p><p><img src="https://i.imgur.com/KIlcMJS.png" alt=""></p><p><img src="https://i.imgur.com/K6IXNSF.png" alt=""></p><h3 id="导出HTML"><a href="#导出HTML" class="headerlink" title="导出HTML"></a>导出HTML</h3><p>然后来导出HTML，这样才能看见侧目录。<br>选择<code>文件--&gt;导出--&gt;导出 HTML</code>,然后保存到本地即可。<br><img src="https://i.imgur.com/m1Q2OuZ.png" alt=""></p><p>然后就可看到效果了</p><p><img src="https://i.imgur.com/IjHSC6W.png" alt=""></p><p>本文链接: <a href="https://www.lansheng.net.cn/blog/59af15ef/">带书签JS设置1</a></p></div><footer class="post-footer"><div class="post-eof"></div></footer></div></article><article class="post post-type-normal" itemscope itemtype="http://schema.org/Article"><div class="post-block"><link itemprop="mainEntityOfPage" href="https://www.lansheng.net.cn/blog/6aff1849/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="name" content="蓝生"><meta itemprop="description" content=""><meta itemprop="image" content="/images/avatar.jpg"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="蓝生的博客"></span><header class="post-header"><h1 class="post-title" itemprop="name headline"><a class="post-title-link" href="/blog/6aff1849/" itemprop="url">小技巧-cmd常用命令之创建文件</a></h1><div class="post-meta"><span class="post-time"><span class="post-meta-item-icon"><i class="fa fa-calendar-o"></i> </span><span class="post-meta-item-text">发表于</span> <time title="创建时间：2018-08-03 14:03:56" itemprop="dateCreated datePublished" datetime="2018-08-03T14:03:56+08:00">2018-08-03</time> <span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="fa fa-calendar-check-o"></i> </span><span class="post-meta-item-text">更新于</span> <time title="修改时间：2018-11-05 17:17:08" itemprop="dateModified" datetime="2018-11-05T17:17:08+08:00">2018-11-05</time> </span><span class="post-category"><span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="fa fa-folder-o"></i> </span><span class="post-meta-item-text">分类于</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/其他/" itemprop="url" rel="index"><span itemprop="name">其他</span></a></span> </span><span class="post-comments-count"><span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="fa fa-comment-o"></i> </span><a href="/blog/6aff1849/#comments" itemprop="discussionUrl"><span class="post-meta-item-text">评论数：</span> <span class="post-comments-count valine-comment-count" data-xid="/blog/6aff1849/" itemprop="commentCount"></span></a></span></div></header><div class="post-body" itemprop="articleBody"><p>一、建立空文件的几种方法<br>1、<code>cd.&gt;a.txt</code><br>cd.表示改变当前目录为当前目录，即等于没改变；而且cd命令不会有输出。<br>“&gt;”表示把命令输出写入到文件。后面跟着a.txt，就表示写入到a.txt。<br>而此例中命令不会有输出，所以就创建了没有内容的空文件。<br><img src="https://i.imgur.com/jLjCU4z.png" alt=""><br>当然不用写地址也是可以的，也就是说<code>cd &gt;1.txt</code>也是可以的。<br><img src="https://i.imgur.com/s914p7I.png" alt=""></p><p>2、<code>copy nul a.txt</code><br><strong>nul表示空设备</strong>，从概念上讲，它不可见，存在于每个目录中，可以把它看成一个特殊的“文件”，它没有内容；<strong>一般可把输出写入到nul，来达到屏蔽输出的目的</strong>，如pause&gt;nul，此命令执行效果是暂停，并且不会显示“请按任意键继续…”。<br>此例子表示将空设备复制到a.txt，同样创建了没有内容的空文件。<br><img src="https://i.imgur.com/IMKmwSW.png" alt=""><br>3、<code>type nul&gt;a.txt</code><br>此例子表示显示空设备的内容，并写入到a.txt。空目录没有内容，所以也就是创建了一个空文件。<br><img src="https://i.imgur.com/gvC4DMB.png" alt=""></p><p>4、<code>echo a 2&gt;a.txt</code><br><strong>“<code>2</code>”表示错误输出的句柄</strong>，此例中没有错误输出，所以创建了没有内容的空文件。<br>其实<strong><code>&gt;</code>默认都是重定向了<code>句柄1</code>，即标准输出句柄</strong>。比如cd.&gt;a.txt，其实就是cd. 1&gt;a.txt。<br>同样，句柄3到9也可以使用在本例中，它们是未经定义的句柄，也不会有输出，如<br>echo a 3&gt;a.txt。</p><p>5、fsutil file createnew d:\a.txt 0<br>使用fsutil创建了一个空文件。</p><p>6、其他命令<br><strong>只要没有输出，并重定向到文件就可以了</strong></p><p>二、建立非空文件的几种方法<br>1、echo a&gt;a.txt<br>最常用的是echo命令，此例子表示把字母a和回车换行覆盖输出到a.txt（如果a.txt原来已有内容则覆盖掉原来的内容），如果追加内容，可以使用&gt;&gt;，如echo b&gt;&gt;a.txt，表示把b和回车换行追加到文件末尾。</p><p>2、其他命令的重定向输出，如<br>type a.txt &gt; b.txt<br>copy a.txt b.txt<br>fsutil file createnew d:\a.txt 1<br>转载自<br><a href="https://zhidao.baidu.com/question/277563240.html" target="_blank" rel="noopener">百度知道-cmd 如何新建文件</a></p><p>本文链接: <a href="https://www.lansheng.net.cn/blog/6aff1849/">小技巧-cmd常用命令之创建文件</a></p></div><footer class="post-footer"><div class="post-eof"></div></footer></div></article><article class="post post-type-normal" itemscope itemtype="http://schema.org/Article"><div class="post-block"><link itemprop="mainEntityOfPage" href="https://www.lansheng.net.cn/blog/39d991de/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="name" content="蓝生"><meta itemprop="description" content=""><meta itemprop="image" content="/images/avatar.jpg"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="蓝生的博客"></span><header class="post-header"><h1 class="post-title" itemprop="name headline"><a class="post-title-link" href="/blog/39d991de/" itemprop="url">使用git上传本地项目到GitHub上和更新</a></h1><div class="post-meta"><span class="post-time"><span class="post-meta-item-icon"><i class="fa fa-calendar-o"></i> </span><span class="post-meta-item-text">发表于</span> <time title="创建时间：2018-08-02 15:17:26" itemprop="dateCreated datePublished" datetime="2018-08-02T15:17:26+08:00">2018-08-02</time> <span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="fa fa-calendar-check-o"></i> </span><span class="post-meta-item-text">更新于</span> <time title="修改时间：2018-11-05 17:17:05" itemprop="dateModified" datetime="2018-11-05T17:17:05+08:00">2018-11-05</time> </span><span class="post-category"><span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="fa fa-folder-o"></i> </span><span class="post-meta-item-text">分类于</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/git教程/" itemprop="url" rel="index"><span itemprop="name">git教程</span></a></span> </span><span class="post-comments-count"><span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="fa fa-comment-o"></i> </span><a href="/blog/39d991de/#comments" itemprop="discussionUrl"><span class="post-meta-item-text">评论数：</span> <span class="post-comments-count valine-comment-count" data-xid="/blog/39d991de/" itemprop="commentCount"></span></a></span></div></header><div class="post-body" itemprop="articleBody"><p>使用git上传本地项目到GitHub上和更新<br>最近在玩GitHub这个基友平台，在这里做个总结，方便以后查阅，也可以给网友们做个参考。<br><strong>一：注册GitHub账号和下载git。</strong><br><strong>二：在GitHub上新建个仓库</strong>，点+号再点击<code>New repository</code>，给你的仓库起个名字，我的是test。<br><img src="https://images2017.cnblogs.com/blog/1214959/201711/1214959-20171109092743356-1757164386.jpg" alt=""></p><p><img src="https://images2017.cnblogs.com/blog/1214959/201711/1214959-20171109093101247-1143276449.jpg" alt=""><br><br><strong>三：安装git</strong>，我安装的是win64版本，直接解压安装就好。在本地磁盘找一个文件夹作为本地仓库，选择Git Bash Here，切换到/e/te 目录下，输入git init初始化，发现目录下多了一个.git文件夹。<br><img src="https://images2017.cnblogs.com/blog/1214959/201711/1214959-20171109093734716-1606118198.jpg" alt=""><br><img src="https://images2017.cnblogs.com/blog/1214959/201711/1214959-20171109094827934-1230236170.jpg" alt=""><br><img src="https://images2017.cnblogs.com/blog/1214959/201711/1214959-20171109094857966-1693570795.jpg" alt=""><br><strong>四：配置ssh key值</strong><br>在git命令行中对git进行全局设置，<br></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">git config --global user.name &quot;你的GitHub用户名&quot;</span><br><span class="line">git config --global user.email &quot;你的GitHub邮箱地址&quot;</span><br></pre></td></tr></table></figure><p></p><p><img src="https://images2017.cnblogs.com/blog/1214959/201711/1214959-20171109095703513-1069227161.jpg" alt=""></p><p>在git命令行中，输入命令： cd ~/.ssh，来检测是否生成过key,没有生成过key，会有相关信息提示；然后输入命令： ssh-keygen -t rsa -C “邮箱地址”，按下回车键；然后根据返回的信息，找到.ssh目录下的两个文件；<br><img src="https://images2017.cnblogs.com/blog/1214959/201711/1214959-20171109100717231-679281242.jpg" alt=""><br><br>在github网站上点击“setting”，找到添加SSH key的菜单，然后新增SSH key；把文件id_rsa.pub 里面的内容全部复制到 key编辑框中，Title可以随便命名，保存完毕；<br><img src="https://images2017.cnblogs.com/blog/1214959/201711/1214959-20171109102959716-1646619495.jpg" alt=""></p><p>在git-bash中命令行输入：ssh -T <a href="mailto:git@github.com" target="_blank" rel="noopener">git@github.com</a>；这里会要求你输入SSH key密码，如果刚才生成SSH key时未输入密码，密码就为空；然后看到信息：</p><p>ERROR: Hi 用户名! You’ve successfully authenticated，but GitHub does not provide shell access.；说明配置成功；</p><p>登陆到github上查看刚刚输入的SSH key，现在图标的颜色变为绿色，说明密钥配置有效；现在可以在git命令行上进行git操作了；<br><img src="https://images2017.cnblogs.com/blog/1214959/201711/1214959-20171109103846028-153793615.jpg" alt=""></p><p><strong>五：上传本地项目到仓库</strong></p><p><strong>（1）远程仓库</strong><br></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ git remote add origin git@github.com:用户名/项目名</span><br></pre></td></tr></table></figure><p></p><p><img src="https://images2017.cnblogs.com/blog/1214959/201711/1214959-20171109105248622-376913523.jpg" alt=""></p><p><strong>（2）添加你要上传的文件</strong>，<br></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git add .</span><br></pre></td></tr></table></figure><p></p><p><code>.</code>代表上传目录下所有文件，可以在<code>git add</code>后面加上你要添加的特定文件，比如<code>git add aa.html</code><br><img src="https://images2017.cnblogs.com/blog/1214959/201711/1214959-20171109105846528-1532870439.jpg" alt=""><br><strong>(3)提交项目</strong>，输入<br></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git commit -a -m &quot;提交说明&quot;</span><br></pre></td></tr></table></figure><p></p><p><strong>(4)推送到GitHub上的master分支</strong><br>再输入<br></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git push origin master</span><br></pre></td></tr></table></figure><p></p><p><img src="https://images2017.cnblogs.com/blog/1214959/201711/1214959-20171109110138091-1582511346.jpg" alt=""><br>大功告成，可以在GitHub查看项目<br><img src="https://images2017.cnblogs.com/blog/1214959/201711/1214959-20171109110521934-2132006458.jpg" alt=""></p><h2 id="更新项目"><a href="#更新项目" class="headerlink" title="更新项目"></a>更新项目</h2><p>更新项目，先添加文件(<code>git add .</code>)，再提交<code>git commit -m &quot;说明&quot;</code>，更新前最好用<code>git pull origin master</code>更新一下你的本地项目，因为可能有别人做了更新。最后再推送到远程仓库<code>git push origin master</code>就行了。<br><img src="https://images2017.cnblogs.com/blog/1214959/201711/1214959-20171109110853559-1249314412.jpg" alt=""></p><p>本文链接: <a href="https://www.lansheng.net.cn/blog/39d991de/">使用git上传本地项目到GitHub上和更新</a></p></div><footer class="post-footer"><div class="post-eof"></div></footer></div></article><article class="post post-type-normal" itemscope itemtype="http://schema.org/Article"><div class="post-block"><link itemprop="mainEntityOfPage" href="https://www.lansheng.net.cn/blog/afb052f3/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="name" content="蓝生"><meta itemprop="description" content=""><meta itemprop="image" content="/images/avatar.jpg"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="蓝生的博客"></span><header class="post-header"><h1 class="post-title" itemprop="name headline"><a class="post-title-link" href="/blog/afb052f3/" itemprop="url">上传本地代码及更新代码到GitHub教程</a></h1><div class="post-meta"><span class="post-time"><span class="post-meta-item-icon"><i class="fa fa-calendar-o"></i> </span><span class="post-meta-item-text">发表于</span> <time title="创建时间：2018-08-02 14:12:57" itemprop="dateCreated datePublished" datetime="2018-08-02T14:12:57+08:00">2018-08-02</time> <span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="fa fa-calendar-check-o"></i> </span><span class="post-meta-item-text">更新于</span> <time title="修改时间：2018-11-05 17:17:05" itemprop="dateModified" datetime="2018-11-05T17:17:05+08:00">2018-11-05</time> </span><span class="post-category"><span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="fa fa-folder-o"></i> </span><span class="post-meta-item-text">分类于</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/git教程/" itemprop="url" rel="index"><span itemprop="name">git教程</span></a></span> </span><span class="post-comments-count"><span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="fa fa-comment-o"></i> </span><a href="/blog/afb052f3/#comments" itemprop="discussionUrl"><span class="post-meta-item-text">评论数：</span> <span class="post-comments-count valine-comment-count" data-xid="/blog/afb052f3/" itemprop="commentCount"></span></a></span></div></header><div class="post-body" itemprop="articleBody"><h2 id="上传本地代码"><a href="#上传本地代码" class="headerlink" title="上传本地代码"></a>上传本地代码</h2><p><strong>第一步：去github上创建自己的Repository</strong>，创建页面如下图所示：<br><img src="https://images2017.cnblogs.com/blog/1249529/201710/1249529-20171025111734035-171097772.png" alt=""><br>红框为新建的仓库的https地址<br><img src="https://images2017.cnblogs.com/blog/1249529/201710/1249529-20171025111740348-1861677831.png" alt=""><br><strong>第二步：打开你的工程目录</strong><br>我这里没有是个空目录，所以先来创建一个文件，在工程目录(Test)下新建一个文件<code>README.md</code><br></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">echo &quot;# Test&quot; &gt;&gt; README.md</span><br></pre></td></tr></table></figure><p></p><p><strong>第三步：建立git仓库</strong><br></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git init</span><br></pre></td></tr></table></figure><p></p><p><strong>第四步：将项目的所有文件添加到仓库中</strong><br></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git add .</span><br></pre></td></tr></table></figure><p></p><p><strong>第五步：提交到仓库</strong><br></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git commit -m &quot;提交说明&quot;</span><br></pre></td></tr></table></figure><p></p><p><strong>第六步：将本地的仓库关联到GitHub</strong><br>后面的https改成刚刚自己的地址，上面的红框处<br></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git remote add origin https://github.com/zlxzlxzlx/Test.git</span><br></pre></td></tr></table></figure><p></p><p><strong>第七步：上传代码到GitHub远程仓库</strong><br>因为这里是第一次上传，所以需要加上<code>-u</code>，参数，后面上传就不用加<code>-u</code>参数了直接使用<code>git push origin master</code>推送到主分支上就行了<br></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git push -u origin master</span><br></pre></td></tr></table></figure><p></p><p>中间可能会让你输入Username和Password，你只要输入github的账号和密码就行了。执行完后，如果没有异常，等待执行完就上传成功了。</p><h2 id="更新代码"><a href="#更新代码" class="headerlink" title="更新代码"></a>更新代码</h2><p><strong>第一步：查看当前的git仓库状态</strong>，可以使用git status<br></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git status</span><br></pre></td></tr></table></figure><p></p><p><strong>第二步：更新全部</strong><br></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git add *</span><br></pre></td></tr></table></figure><p></p><p><strong>第三步：接着输入git commit -m “更新说明”</strong><br></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git commit -m &quot;更新说明&quot;</span><br></pre></td></tr></table></figure><p></p><p><strong>第四步：先git pull,拉取当前分支最新代码</strong><br></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git pull</span><br></pre></td></tr></table></figure><p></p><p>第五步：push到远程master分支上</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git push origin master</span><br></pre></td></tr></table></figure><p>不出意外，打开GitHub已经同步了</p><p>本文参考：<a href="https://www.cnblogs.com/zlxbky/p/7727895.html" target="_blank" rel="noopener">https://www.cnblogs.com/zlxbky/p/7727895.html</a></p><p>本文链接: <a href="https://www.lansheng.net.cn/blog/afb052f3/">上传本地代码及更新代码到GitHub教程</a></p></div><footer class="post-footer"><div class="post-eof"></div></footer></div></article><article class="post post-type-normal" itemscope itemtype="http://schema.org/Article"><div class="post-block"><link itemprop="mainEntityOfPage" href="https://www.lansheng.net.cn/blog/be26f7a6/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="name" content="蓝生"><meta itemprop="description" content=""><meta itemprop="image" content="/images/avatar.jpg"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="蓝生的博客"></span><header class="post-header"><h1 class="post-title" itemprop="name headline"><a class="post-title-link" href="/blog/be26f7a6/" itemprop="url">git上传项目全部流程</a></h1><div class="post-meta"><span class="post-time"><span class="post-meta-item-icon"><i class="fa fa-calendar-o"></i> </span><span class="post-meta-item-text">发表于</span> <time title="创建时间：2018-08-02 13:17:50" itemprop="dateCreated datePublished" datetime="2018-08-02T13:17:50+08:00">2018-08-02</time> <span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="fa fa-calendar-check-o"></i> </span><span class="post-meta-item-text">更新于</span> <time title="修改时间：2018-11-05 17:17:04" itemprop="dateModified" datetime="2018-11-05T17:17:04+08:00">2018-11-05</time> </span><span class="post-category"><span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="fa fa-folder-o"></i> </span><span class="post-meta-item-text">分类于</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/git教程/" itemprop="url" rel="index"><span itemprop="name">git教程</span></a></span> </span><span class="post-comments-count"><span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="fa fa-comment-o"></i> </span><a href="/blog/be26f7a6/#comments" itemprop="discussionUrl"><span class="post-meta-item-text">评论数：</span> <span class="post-comments-count valine-comment-count" data-xid="/blog/be26f7a6/" itemprop="commentCount"></span></a></span></div></header><div class="post-body" itemprop="articleBody"><h2 id="一、下载git"><a href="#一、下载git" class="headerlink" title="一、下载git"></a>一、下载git</h2><p>进入网址：<a href="https://git-scm.com/downloads；" target="_blank" rel="noopener">https://git-scm.com/downloads；</a><br><img src="https://images2017.cnblogs.com/blog/1322155/201801/1322155-20180120160852662-37045569.png" alt=""><br>点击中的Download 2.16.0 for Windows;<br><img src="https://images2017.cnblogs.com/blog/1322155/201801/1322155-20180120161042428-614927451.png" alt=""></p><p>在中选择蓝色字段点击，根据电脑64或32位选择适合的下载，点击即可进行下载，下载完成后傻瓜式安装，一直点击下一步即可完成安装；</p><p>安装完成后，鼠标右击桌面，会发现：“Git Bash Here”,选择进入git命令行</p><h2 id="二、在github上新建个远程厂库"><a href="#二、在github上新建个远程厂库" class="headerlink" title="二、在github上新建个远程厂库"></a>二、在github上新建个远程厂库</h2><p>在此页面进行注册，注册完了在右上角有个：“Sign in”,点击进入进行登录；<br><img src="https://images2017.cnblogs.com/blog/1322155/201801/1322155-20180120162101099-542604259.png" alt=""></p><p>登录成功后，在右下方寻找，点击New repository，然后在此处</p><p><img src="https://images2017.cnblogs.com/blog/1322155/201801/1322155-20180120162525224-1063916899.png" alt=""><br>填写你新建的厂库名，这里用“fire”作为示例，填完点击下方绿色框内的“Create repository”即可完成厂库的新建</p><p><img src="https://images2017.cnblogs.com/blog/1322155/201801/1322155-20180120162657334-1430375785.png" alt=""></p><h2 id="三、利用git命令行连接github"><a href="#三、利用git命令行连接github" class="headerlink" title="三、利用git命令行连接github"></a>三、利用git命令行连接github</h2><p>在连接远程厂库前，必须确保电脑连接了自己的GitHub</p><h3 id="1、配置秘钥"><a href="#1、配置秘钥" class="headerlink" title="1、配置秘钥"></a>1、配置秘钥</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ ssh-keygen -t rsa -C &quot;your_email@youremail.com&quot;</span><br></pre></td></tr></table></figure><p>此处的”<a href="mailto:`your_email@youremail.com" target="_blank" rel="noopener">`your_email@youremail.com</a><code>&quot;改为你自己的邮箱，回车之后一直回车就行，结束后你会在</code>C:\Users\Administrator.ssh<code>目录下看到“</code>id_rsa.pub<code>”，使用记事本打开，然后复制里面的内容，然后打开你的github账号，找到这个页面选择</code>Settings<code>，点击进入在左边出现的目录中有：“</code>SSH and GPG keys”<code>,选择它会在右上角出现一个绿色框，里面有文字：“</code>New SSH key<code>”,点击然后在&quot;</code>Key<code>&quot;中把你刚刚复制的粘贴上去，“</code>Title`”可以随便填，没什么用。<br><img src="https://images2017.cnblogs.com/blog/1322155/201801/1322155-20180120163907162-1205073827.png" alt=""></p><h3 id="2、验证连接是否成功"><a href="#2、验证连接是否成功" class="headerlink" title="2、验证连接是否成功"></a>2、验证连接是否成功</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ ssh -T git@github.com</span><br></pre></td></tr></table></figure><p>如果回车看到：<code>You&#39;ve successfully authenticated</code>,<code>but GitHub dose not provide shell access</code>,表示已经成功连上<code>github</code>。</p><h3 id="3、设置username和email"><a href="#3、设置username和email" class="headerlink" title="3、设置username和email"></a>3、设置username和email</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ git config --global user.name &quot;your name&quot;</span><br><span class="line"></span><br><span class="line">$ git config --global user.name &quot;your_email@youremail.com&quot;</span><br></pre></td></tr></table></figure><p>在项目每次上传的时候每次commit都会记录你的username和email，所以要设置</p><h2 id="四、连接远程厂库"><a href="#四、连接远程厂库" class="headerlink" title="四、连接远程厂库"></a>四、连接远程厂库</h2><p>基本配置完成，接下来就是上传你要上传的项目了。</p><h3 id="1、初始化git"><a href="#1、初始化git" class="headerlink" title="1、初始化git"></a>1、初始化git</h3><p><strong>进入你要上传的项目的文件夹</strong>，在文件夹内鼠标右击，选择“<code>Git Bash Here</code>”打开<code>git</code>命令行，输入：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ git init</span><br></pre></td></tr></table></figure><p>目的是初始化<code>git</code>，并且会创建个“<code>.git</code>”文件夹，里面有个“<code>config</code>”就是用来保存远程厂库路径地址的，如果想更换厂库可直接在里面对路径进行修改</p><h3 id="2、添加远程厂库"><a href="#2、添加远程厂库" class="headerlink" title="2、添加远程厂库"></a>2、添加远程厂库</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ git remote add origin git@github.com:tt-wedos/fire.git</span><br></pre></td></tr></table></figure><p>这里的“<code>tt-wedos</code>”是我<code>github</code>上的用户名，你们要改成自己的，“<code>fire</code>”是我刚刚创建的厂库名字，你们也要对应改成自己新建的厂库名字</p><h3 id="3-添加项目并上传"><a href="#3-添加项目并上传" class="headerlink" title="3.添加项目并上传"></a>3.添加项目并上传</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ git add .</span><br></pre></td></tr></table></figure><p>注意这里的<code>add</code>后面还有个“<code>.</code>”，小点的意识是选择所有文件进行上传，不能忽略<br></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ git commit -m &apos;my projest push&apos;</span><br></pre></td></tr></table></figure><p></p><p>引号内的内容可以随便填写，目的是描述记录每次上的内容是什么<br>第一次推送master分支的所有内容：<br></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ git push -u origin master</span><br></pre></td></tr></table></figure><p></p><p>第一次要加上-u参数，如果不加的话会推送失败，后面就不需要再加-u参数了。</p><p>此后，每次本地提交后，只要有必要，就可以使用命令<code>git push origin master</code>推送最新修改高GitHub中</p><p>push内容到github上面，如果你的厂库不是新建的，里面以前已经有内容，你再次上传新内容想覆盖，就要在后面加“-f”,代码如下：$ git push origin master -f</p><p>本文链接: <a href="https://www.lansheng.net.cn/blog/be26f7a6/">git上传项目全部流程</a></p></div><footer class="post-footer"><div class="post-eof"></div></footer></div></article><article class="post post-type-normal" itemscope itemtype="http://schema.org/Article"><div class="post-block"><link itemprop="mainEntityOfPage" href="https://www.lansheng.net.cn/blog/d2ebfe94/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="name" content="蓝生"><meta itemprop="description" content=""><meta itemprop="image" content="/images/avatar.jpg"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="蓝生的博客"></span><header class="post-header"><h1 class="post-title" itemprop="name headline"><a class="post-title-link" href="/blog/d2ebfe94/" itemprop="url">文件流和缓冲流的比较_输出缓冲流源码详解</a></h1><div class="post-meta"><span class="post-time"><span class="post-meta-item-icon"><i class="fa fa-calendar-o"></i> </span><span class="post-meta-item-text">发表于</span> <time title="创建时间：2018-07-31 19:34:49" itemprop="dateCreated datePublished" datetime="2018-07-31T19:34:49+08:00">2018-07-31</time> <span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="fa fa-calendar-check-o"></i> </span><span class="post-meta-item-text">更新于</span> <time title="修改时间：2018-11-05 17:17:08" itemprop="dateModified" datetime="2018-11-05T17:17:08+08:00">2018-11-05</time> </span><span class="post-category"><span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="fa fa-folder-o"></i> </span><span class="post-meta-item-text">分类于</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/其他/" itemprop="url" rel="index"><span itemprop="name">其他</span></a></span> </span><span class="post-comments-count"><span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="fa fa-comment-o"></i> </span><a href="/blog/d2ebfe94/#comments" itemprop="discussionUrl"><span class="post-meta-item-text">评论数：</span> <span class="post-comments-count valine-comment-count" data-xid="/blog/d2ebfe94/" itemprop="commentCount"></span></a></span></div></header><div class="post-body" itemprop="articleBody"><p>我们知道使用FileInputStream和FileOutputStream可以实现文件复制，有两种复制方法，一种是读一个字节，写一个字节。方法如下:<br></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">* 使用FileInputStream和FileOutputSteam来复制文件。</span></span><br><span class="line"><span class="comment">*</span></span><br><span class="line"><span class="comment">* <span class="doctag">@param</span> fromPath 源文件</span></span><br><span class="line"><span class="comment">* <span class="doctag">@param</span> toPath 目的文件</span></span><br><span class="line"><span class="comment">* <span class="doctag">@throws</span> FileNotFoundException</span></span><br><span class="line"><span class="comment">* <span class="doctag">@throws</span> IOException</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">copyByFileStreamOneByOne</span><span class="params">(String fromPath, String toPath)</span></span></span><br><span class="line"><span class="function"><span class="keyword">throws</span> FileNotFoundException, IOException</span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    InputStream in = <span class="keyword">new</span> FileInputStream(fromPath);</span><br><span class="line">    OutputStream out = <span class="keyword">new</span> FileOutputStream(toPath);</span><br><span class="line">    <span class="keyword">int</span> readNum = <span class="number">0</span>;</span><br><span class="line">    <span class="comment">// 每次从输入流读取一个字节到readNum中</span></span><br><span class="line">    <span class="keyword">while</span> ((readNum = in.read()) != -<span class="number">1</span>)</span><br><span class="line">    </span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// System.out.println(a++);</span></span><br><span class="line">        <span class="comment">// 把放在readNum中读到的字节写入到输出流中</span></span><br><span class="line">        out.write(readNum);</span><br><span class="line">    &#125;</span><br><span class="line">    in.close();</span><br><span class="line">    out.close();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p></p><p>当然一个字节一个字节的读取时很慢的，所以可以每次读入一个字节数组，然后写入一个字节数组，这样比上面块一点，如下所示。<br></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">* 使用FileInputStream和FileOutputSteam来复制文件。</span></span><br><span class="line"><span class="comment">*</span></span><br><span class="line"><span class="comment">* <span class="doctag">@param</span> fromPath</span></span><br><span class="line"><span class="comment">* <span class="doctag">@param</span> toPath</span></span><br><span class="line"><span class="comment">* <span class="doctag">@throws</span> FileNotFoundException</span></span><br><span class="line"><span class="comment">* <span class="doctag">@throws</span> IOException</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">copyByFileStream</span><span class="params">(String fromPath, String toPath)</span></span></span><br><span class="line"><span class="function"><span class="keyword">throws</span> FileNotFoundException, IOException</span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    InputStream in = <span class="keyword">new</span> FileInputStream(fromPath);</span><br><span class="line">    OutputStream out = <span class="keyword">new</span> FileOutputStream(toPath);</span><br><span class="line">    <span class="comment">// 缓冲数组</span></span><br><span class="line">    <span class="keyword">byte</span>[] buffer = <span class="keyword">new</span> <span class="keyword">byte</span>[<span class="number">1024</span>*<span class="number">10</span>];</span><br><span class="line">    <span class="keyword">int</span> readLength = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">int</span> a = <span class="number">0</span>;</span><br><span class="line">    <span class="comment">// 每次从输入流读取一个数字</span></span><br><span class="line">    <span class="keyword">while</span> ((readLength = in.read(buffer)) != -<span class="number">1</span>)</span><br><span class="line">    </span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// System.out.println(a++);</span></span><br><span class="line">        <span class="comment">// 写入到输出流中</span></span><br><span class="line">        out.write(buffer, <span class="number">0</span>, readLength);</span><br><span class="line">    &#125;</span><br><span class="line">    in.close();</span><br><span class="line">    out.close();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p></p><p>java.io包中还提供了带缓冲的字节流，BufferedInputStream和BufferedOutputStream,这两个字节流可以分别包装上面的FileInputSteam和FileOutpuStream。带缓冲的字节类内部提供了缓冲，</p><p>BufferedInputStream先读取比请求更多的数据到缓冲区(内部字节数字)，当调用read时如果数据已经在缓存区，则直接从缓冲区返回对应数据不做IO操作。缓冲中的数据实际上是保存在内存中，而原始数据可能是保存在硬盘或NandFlash等存储介质中；而我们知道，从内存中读取数据的速度比从硬盘读取数据的速度至少快10倍以上。<br>使用BufferedOutput的write()方法进行写入的时候，write()方法会先写到BuffredOutputStream的内部字节数组中。当内部缓冲写满后，BufferedOutputStream会自动把内部的字节数组写入到文件中。<br>使用带缓冲的字节流进行复制文件如下所示，虽然看起来是一个字节一个字节的读写，但是由于使用缓冲了，这种方式比FileInputStream和FileOutputSteam方式一个字节一个字节的读写方式要快很多很多。<br></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">* 使用BufferedInputStream和BufferOutputStream进行文件复制.</span></span><br><span class="line"><span class="comment">*</span></span><br><span class="line"><span class="comment">* <span class="doctag">@param</span> fromPath</span></span><br><span class="line"><span class="comment">* <span class="doctag">@param</span> toPath</span></span><br><span class="line"><span class="comment">* <span class="doctag">@throws</span> FileNotFoundException</span></span><br><span class="line"><span class="comment">* <span class="doctag">@throws</span> IOException</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">copyByBufferedStreamOneByOne</span><span class="params">(String fromPath, String toPath)</span></span></span><br><span class="line"><span class="function"><span class="keyword">throws</span> FileNotFoundException, IOException</span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    BufferedOutputStream buffOut = <span class="keyword">new</span> BufferedOutputStream(</span><br><span class="line">    <span class="keyword">new</span> FileOutputStream(toPath),<span class="number">1024</span>*<span class="number">10</span>);</span><br><span class="line">    BufferedInputStream buffIn = <span class="keyword">new</span> BufferedInputStream(</span><br><span class="line">    <span class="keyword">new</span> FileInputStream(fromPath),<span class="number">1024</span>*<span class="number">10</span>);</span><br><span class="line">    <span class="keyword">int</span> count = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">int</span> len = <span class="number">0</span>;</span><br><span class="line">    <span class="comment">//		byte[] buf = new byte[1024*10];</span></span><br><span class="line">    <span class="keyword">while</span> ((len = buffIn.read()) != -<span class="number">1</span>)</span><br><span class="line">    </span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">//			System.out.println(count++);</span></span><br><span class="line">        buffOut.write(len);</span><br><span class="line">    &#125;</span><br><span class="line">    buffOut.close();</span><br><span class="line">    buffIn.close();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p></p><p>当然BufferedInputStream和BufferedOutputStream也可以提供一次读取一个数字和一次写入一个数字的方法，方法如下所示。<br></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">* 使用BufferedInputStream和BufferOutputStream进行文件复制.</span></span><br><span class="line"><span class="comment">*</span></span><br><span class="line"><span class="comment">* <span class="doctag">@param</span> fromPath</span></span><br><span class="line"><span class="comment">* <span class="doctag">@param</span> toPath</span></span><br><span class="line"><span class="comment">* <span class="doctag">@throws</span> FileNotFoundException</span></span><br><span class="line"><span class="comment">* <span class="doctag">@throws</span> IOException</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">copyByBufferedStream</span><span class="params">(String fromPath, String toPath)</span> <span class="keyword">throws</span> FileNotFoundException, IOException</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    BufferedOutputStream buffOut = <span class="keyword">new</span> BufferedOutputStream(</span><br><span class="line">    <span class="keyword">new</span> FileOutputStream(toPath));</span><br><span class="line">    BufferedInputStream buffIn = <span class="keyword">new</span> BufferedInputStream(</span><br><span class="line">    <span class="keyword">new</span> FileInputStream(fromPath));</span><br><span class="line">    <span class="keyword">int</span> count = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">int</span> len = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">byte</span>[] buf = <span class="keyword">new</span> <span class="keyword">byte</span>[<span class="number">1024</span>*<span class="number">10</span>];</span><br><span class="line">    <span class="keyword">while</span> ((len = buffIn.read(buf)) != -<span class="number">1</span>)</span><br><span class="line">    </span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">//			System.out.println(count++);</span></span><br><span class="line">        buffOut.write(buf,<span class="number">0</span>,len);</span><br><span class="line">    &#125;</span><br><span class="line">    buffOut.close();</span><br><span class="line">    buffIn.close();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p></p><p>这四种方法复制文件比较：<br></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"></span><br><span class="line">    String fromPath = <span class="string">"C:\\Users\\lan\\Desktop\\副本.png"</span>;</span><br><span class="line">    String toPath = <span class="string">"C:\\Users\\lan\\Desktop\\副本的副本.png"</span>;</span><br><span class="line">    <span class="keyword">long</span> start=System.currentTimeMillis();</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;<span class="number">1000</span>*<span class="number">10</span>;i++)</span><br><span class="line">    &#123;</span><br><span class="line">        copyByFileStream(fromPath, toPath);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">long</span> end=System.currentTimeMillis();</span><br><span class="line">    </span><br><span class="line">    System.out.println(<span class="string">"使用FileInputStream和FileOutputStream复制文件用时:"</span>+(end-start));</span><br><span class="line">    start=System.currentTimeMillis();</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;<span class="number">1000</span>*<span class="number">10</span>;i++)</span><br><span class="line">    &#123;</span><br><span class="line">        copyByBufferedStream(fromPath, toPath);</span><br><span class="line">    &#125;</span><br><span class="line">    end=System.currentTimeMillis();</span><br><span class="line">    System.out.println(<span class="string">"使用BufferdInputStream和BufferedOutputStream复制文件用时:"</span>+(end-start));</span><br><span class="line">    start=System.currentTimeMillis();</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;<span class="number">1000</span>*<span class="number">10</span>;i++)</span><br><span class="line">    &#123;</span><br><span class="line">        copyByBufferedStreamOneByOne(fromPath, toPath);</span><br><span class="line">    &#125;</span><br><span class="line">    end=System.currentTimeMillis();</span><br><span class="line">    System.out.println(<span class="string">"使用BufferdInputStream和BufferedOutputStream逐个字节复制文件用时:"</span>+(end-start));</span><br><span class="line">    start=System.currentTimeMillis();</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;<span class="number">100</span>;i++)</span><br><span class="line">    </span><br><span class="line">    &#123;</span><br><span class="line">        copyByFileStreamOneByOne(fromPath, toPath);</span><br><span class="line">    &#125;</span><br><span class="line">    end=System.currentTimeMillis();</span><br><span class="line">    System.out.println(<span class="string">"使用FileInputStream和FileOutputStream逐个字节复制文件用时:"</span>+(end-start));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p></p><p><strong>运行结果：</strong><br></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">使用FileInputStream和FileOutputStream复制文件用时:17499</span><br><span class="line">使用BufferdInputStream和BufferedOutputStream复制文件用时:16165</span><br><span class="line">使用BufferdInputStream和BufferedOutputStream逐个字节复制文件用时:32333</span><br><span class="line">使用FileInputStream和FileOutputStream逐个字节复制文件用时:40719</span><br></pre></td></tr></table></figure><p></p><p><strong>先来看按数组读取的情况：</strong><br>可以看到，使用FileInputStream和FileOutputStream每次读写<code>1024*10</code>个字节的数组，与使用BufferInputStream和BufferOutputStream每次读取<code>1024*10</code>个字节的数组。速度差不多，可能使用缓冲方式会快一点。</p><p><strong>按字节逐个字节读写的情况：</strong><br>可以发现使用缓冲流逐个字节读取的情况还是挺快的，使用缓冲流逐个字节读写方式，复制一个文件1000*10次的事件为32333，而使用文件流读写100次就用时40719。这两个简直一个天上一个地下。</p><p>所以说<strong>如果是逐个字符方式进行读写的话，使用缓冲流效率更好。</strong></p><h2 id="BufferedOutputStream源码分析"><a href="#BufferedOutputStream源码分析" class="headerlink" title="BufferedOutputStream源码分析"></a>BufferedOutputStream源码分析</h2><p>要介绍BufferedOutputStream，我们先了解一下OutputStream类<br>抽象类OutputStream类有三个write方法</p><h3 id="OutputStream源码："><a href="#OutputStream源码：" class="headerlink" title="OutputStream源码："></a>OutputStream源码：</h3><p>参考文章：<a href="https://blog.csdn.net/u010149189/article/details/51355523" target="_blank" rel="noopener">BufferedOutputStream的缓存功能解析（源码阅读）</a><br></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> java.io;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">OutputStream</span> <span class="keyword">implements</span> <span class="title">Closeable</span>, <span class="title">Flushable</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">write</span><span class="params">(<span class="keyword">int</span> b)</span> <span class="keyword">throws</span> IOException</span>;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">write</span><span class="params">(<span class="keyword">byte</span> b[])</span> <span class="keyword">throws</span> IOException </span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        write(b, <span class="number">0</span>, b.length);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">write</span><span class="params">(<span class="keyword">byte</span> b[], <span class="keyword">int</span> off, <span class="keyword">int</span> len)</span> <span class="keyword">throws</span> IOException </span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (b == <span class="keyword">null</span>) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> NullPointerException();</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> ((off &lt; <span class="number">0</span>) || (off &gt; b.length) || (len &lt; <span class="number">0</span>) ||</span><br><span class="line">                   ((off + len) &gt; b.length) || ((off + len) &lt; <span class="number">0</span>)) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> IndexOutOfBoundsException();</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (len == <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span> ; i &lt; len ; i++) &#123;</span><br><span class="line">            write(b[off + i]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">flush</span><span class="params">()</span> <span class="keyword">throws</span> IOException </span>&#123;&#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">close</span><span class="params">()</span> <span class="keyword">throws</span> IOException </span>&#123;&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p></p><p>可以看到OutputStream一共定义了以上5个方法。有三个write()方法，一个flush()方法，一个close()方法。<br>现在主要来看着三个write()方法<br></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">write</span><span class="params">(<span class="keyword">int</span> b)</span></span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">write</span><span class="params">(<span class="keyword">byte</span> b[])</span></span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">write</span><span class="params">(<span class="keyword">byte</span> b[], <span class="keyword">int</span> off, <span class="keyword">int</span> len)</span></span></span><br></pre></td></tr></table></figure><p></p><p>第一个方法<code>public abstract void write(int b)</code>使用<code>abstract</code>修饰，所以第一个方法明显是让子类去覆盖的,第二个方法源码如下。<br></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">write</span><span class="params">(<span class="keyword">byte</span> b[])</span> <span class="keyword">throws</span> IOException </span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    write(b, <span class="number">0</span>, b.length);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p></p><p>可以看到，这个写整个数组的方法还是调用第三个方法去实现的，第三个方法的源码如下<br></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">write</span><span class="params">(<span class="keyword">byte</span> b[], <span class="keyword">int</span> off, <span class="keyword">int</span> len)</span> <span class="keyword">throws</span> IOException </span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (b == <span class="keyword">null</span>) &#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> NullPointerException();</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> ((off &lt; <span class="number">0</span>) || (off &gt; b.length) || (len &lt; <span class="number">0</span>) ||</span><br><span class="line">               ((off + len) &gt; b.length) || ((off + len) &lt; <span class="number">0</span>)) &#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> IndexOutOfBoundsException();</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (len == <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span> ; i &lt; len ; i++) &#123;</span><br><span class="line">    <span class="comment">//调用前面的抽象方法write（int b）同时进行类型转换</span></span><br><span class="line">        write(b[off + i]);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p></p><p>问题<br>我们先不看抽象方法是如何实现的，也就是说OutputStream也具有缓存器功能，不过这个缓冲器(byte数组)要我们自己提供，然后我们可以将要写入到流中的数据写到这个byte数组中，然后调用write(byte b[])或者write(byte b[], int off, int len)就可以吧缓存在数组中的数据写入输出流中。</p><p>那为什么还要BufferedInputStream类干什么呢，他们有什么区别呢。同时我们知道BufferedInputStream类中还有一个flush()方法，在OutputStream流中没有flush()方法，这又是为什么呢？flush()是不是必须的呢，接下来看一下BufferedOutputStream的源码。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> java.io;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">BufferedOutputStream</span> <span class="keyword">extends</span> <span class="title">FilterOutputStream</span> </span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="comment">//内部缓存数组</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">byte</span> buf[];</span><br><span class="line">    <span class="comment">//记录内部缓存数组内已经放了多少个字节</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">int</span> count;</span><br><span class="line">    <span class="comment">//默认构造函数</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">BufferedOutputStream</span><span class="params">(OutputStream out)</span> </span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>(out, <span class="number">8192</span>);<span class="comment">//调用带参构造函数，设置默认缓存数组大小为8192</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//带参构造函数，设置缓存区大小</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">BufferedOutputStream</span><span class="params">(OutputStream out, <span class="keyword">int</span> size)</span> </span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>(out);</span><br><span class="line">        <span class="keyword">if</span> (size &lt;= <span class="number">0</span>) </span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> IllegalArgumentException(<span class="string">"Buffer size &lt;= 0"</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        buf = <span class="keyword">new</span> <span class="keyword">byte</span>[size];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//刷新缓存写入文件</span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">flushBuffer</span><span class="params">()</span> <span class="keyword">throws</span> IOException </span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="comment">//计数器大于0，表示内部缓存中有字节</span></span><br><span class="line">        <span class="keyword">if</span> (count &gt; <span class="number">0</span>) </span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">//调用低层低级流的写数组方法，内部缓存</span></span><br><span class="line">            out.write(buf, <span class="number">0</span>, count);</span><br><span class="line">            <span class="comment">//计数器重新置零</span></span><br><span class="line">            count = <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//写字节方法</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">synchronized</span> <span class="keyword">void</span> <span class="title">write</span><span class="params">(<span class="keyword">int</span> b)</span> <span class="keyword">throws</span> IOException </span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="comment">//如果count长度大于内部缓存的大小</span></span><br><span class="line">        <span class="keyword">if</span> (count &gt;= buf.length) </span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">//就刷新内部缓存</span></span><br><span class="line">            flushBuffer();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//把这个字节放到内部缓存中(写到内部缓存中，而不是写文件)</span></span><br><span class="line">        buf[count++] = (<span class="keyword">byte</span>)b;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//写数组方法</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">synchronized</span> <span class="keyword">void</span> <span class="title">write</span><span class="params">(<span class="keyword">byte</span> b[], <span class="keyword">int</span> off, <span class="keyword">int</span> len)</span> <span class="keyword">throws</span> IOException </span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="comment">//如果数组的长度大于或等于内部缓存的长度，那是没办法放入缓存中的</span></span><br><span class="line">        <span class="keyword">if</span> (len &gt;= buf.length) </span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">//先把之前读取到缓存中的数据写入低层</span></span><br><span class="line">            flushBuffer();</span><br><span class="line">            <span class="comment">//然后直接调用out(低级流如FileOutputStream out)的写数组方法把这次读取到的数据写入低层中</span></span><br><span class="line">            out.write(b, off, len);</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//如果传入的数组，长度小于内部缓存的长度</span></span><br><span class="line">        <span class="comment">//说明内部缓存剩余位置不够放，</span></span><br><span class="line">        <span class="keyword">if</span> (len &gt; buf.length - count) </span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">//先把内部缓存写文件，这样才能挪出位置放下这个数组</span></span><br><span class="line">            flushBuffer();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//把这个数字复制到内部缓存中</span></span><br><span class="line">        System.arraycopy(b, off, buf, count, len);</span><br><span class="line">        <span class="comment">//更新计数器</span></span><br><span class="line">        count += len;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//强制写文件</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">synchronized</span> <span class="keyword">void</span> <span class="title">flush</span><span class="params">()</span> <span class="keyword">throws</span> IOException </span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="comment">//写入内部缓存到文件中</span></span><br><span class="line">        flushBuffer();</span><br><span class="line">        <span class="comment">//调用低层低级流的刷新方法，这个out是继承来的</span></span><br><span class="line">        out.flush();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>结论：<br>OutputStream的缓存器（自定义数组）与BufferedOutputStream中类的缓存器（内部数组）本质是一样的，只是BufferedOutputStream类中将要写入到底层io流中的数据先放到内部数字中去凑个整，然后再一起写入底层io流中。<br>区别在于OutputStream写数组的时候，数组中有多好字节就写多少字节，BufferedOutputStream写数组的时候，如果这个数组能放到内部缓存中就放到内部缓存中，如果不能就写入这个数组。这样就是使用BufferedOutputStream可能会少写几次数组，从而提高效率。</p><p>这样也出现了一个问题，假设向硬盘中写入一个文件，文件最后读到的数据比BufferedOutputSteam内部缓存长度要小，则BufferOutputStream就不会将这些数据写入底层io流中，这样造成文件缺失，因此就需要在close()前调用flush（）方法，强制将还没有装满buf数组的数据写入底层io中。<br></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@SuppressWarnings</span>(<span class="string">"try"</span>)</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">close</span><span class="params">()</span> <span class="keyword">throws</span> IOException </span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">try</span> (OutputStream ostream = out) </span><br><span class="line">    &#123;</span><br><span class="line">        flush();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p></p><p><strong>对比三个读写数组的方式</strong><br>方式1：使用FileInputStream和FileOutputStream复制文件，每次读写10240个字节<br></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">copyByFileStream</span><span class="params">(File fromPath, File toFile)</span></span></span><br><span class="line"><span class="function">    <span class="keyword">throws</span> FileNotFoundException, IOException</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    InputStream in = <span class="keyword">new</span> FileInputStream(fromPath);</span><br><span class="line">    OutputStream out = <span class="keyword">new</span> FileOutputStream(toFile);</span><br><span class="line"><span class="comment">//  缓冲数组</span></span><br><span class="line">    <span class="keyword">byte</span>[] buffer = <span class="keyword">new</span> <span class="keyword">byte</span>[<span class="number">10240</span>];</span><br><span class="line">    <span class="keyword">int</span> readLength = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">int</span> a = <span class="number">0</span>;</span><br><span class="line"><span class="comment">//  每次从输入流读取一个数字</span></span><br><span class="line">    <span class="keyword">while</span> ((readLength = in.read(buffer)) != -<span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line"><span class="comment">//      System.out.println(a++);</span></span><br><span class="line"><span class="comment">//      写入到输出流中</span></span><br><span class="line">        out.write(buffer, <span class="number">0</span>, readLength);</span><br><span class="line">    &#125;</span><br><span class="line">    in.close();</span><br><span class="line">    out.close();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p></p><p>方式二：使用默认长度(<code>8192</code>)的BufferedInputStream和BufferedOutputStream复制文件，同样每次读写<code>10240</code>字节<br></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">copyByBufferedStream</span><span class="params">(File fromPath, File toPath)</span></span></span><br><span class="line"><span class="function">    <span class="keyword">throws</span> FileNotFoundException, IOException</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    BufferedOutputStream buffOut = <span class="keyword">new</span> BufferedOutputStream(</span><br><span class="line">    <span class="keyword">new</span> FileOutputStream(toPath));</span><br><span class="line">    BufferedInputStream buffIn = <span class="keyword">new</span> BufferedInputStream(</span><br><span class="line">    <span class="keyword">new</span> FileInputStream(fromPath));</span><br><span class="line">    <span class="keyword">int</span> count = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">int</span> len = <span class="number">0</span>;</span><br><span class="line">    <span class="comment">//这个数组长度比8192大，内部缓存放不下，会把缓存中的数据写入文件，然后写入读入的这个数组</span></span><br><span class="line">    <span class="keyword">byte</span>[] buf = <span class="keyword">new</span> <span class="keyword">byte</span>[<span class="number">10240</span>];</span><br><span class="line">    <span class="keyword">while</span> ((len = buffIn.read(buf)) != -<span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line"><span class="comment">//      System.out.println(count++);</span></span><br><span class="line">        buffOut.write(buf, <span class="number">0</span>, len);</span><br><span class="line">    &#125;</span><br><span class="line">    buffOut.close();</span><br><span class="line">    buffIn.close();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p></p><p>第三种方式：使用长度为<code>102400</code>的内部缓存的BufferedInputStream和BufferedOutputStream复制文件，同样每次读写<code>10240</code>字节<br></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">copyByBufferedStream2</span><span class="params">(File fromPath, File toPath)</span></span></span><br><span class="line"><span class="function">    <span class="keyword">throws</span> FileNotFoundException, IOException</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    BufferedOutputStream buffOut = <span class="keyword">new</span> BufferedOutputStream(</span><br><span class="line">    <span class="keyword">new</span> FileOutputStream(toPath),<span class="number">102400</span>);</span><br><span class="line">    BufferedInputStream buffIn = <span class="keyword">new</span> BufferedInputStream(</span><br><span class="line">    <span class="keyword">new</span> FileInputStream(fromPath),<span class="number">102400</span>);</span><br><span class="line">    <span class="keyword">int</span> count = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">int</span> len = <span class="number">0</span>;</span><br><span class="line">    <span class="comment">//这个数组比内部数组长度要小，所以读取的时候会先放入到内部缓存中，缓存满了会下文件，</span></span><br><span class="line">    <span class="comment">//或者而缓存没满，但放不下新数据，则内部缓存先写入文件，再拷贝新数据到缓存中</span></span><br><span class="line">    <span class="keyword">byte</span>[] buf = <span class="keyword">new</span> <span class="keyword">byte</span>[<span class="number">10240</span>];</span><br><span class="line">    <span class="keyword">while</span> ((len = buffIn.read(buf)) != -<span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line"><span class="comment">//      System.out.println(count++);</span></span><br><span class="line">        buffOut.write(buf, <span class="number">0</span>, len);</span><br><span class="line">    &#125;</span><br><span class="line">    buffOut.close();</span><br><span class="line">    buffIn.close();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p></p><p>测试，main方法：<br></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> FileNotFoundException, IOException</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    String fromPath = <span class="string">"C:\\Users\\lan\\Desktop\\副本.png"</span>;</span><br><span class="line">    String toPath = <span class="string">"C:\\Users\\lan\\Desktop\\副本的副本.png"</span>;</span><br><span class="line">    File fromeFile=<span class="keyword">new</span> File(fromPath);</span><br><span class="line">    File toFile=<span class="keyword">new</span> File(toPath);</span><br><span class="line">    <span class="comment">//源文件不存在就退出程序，不然后面这么多次循环，会把电脑搞崩溃的，又没有进行一场处理。</span></span><br><span class="line">    <span class="keyword">if</span>(!fromeFile.exists())</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">long</span> start=System.currentTimeMillis();</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;<span class="number">1000</span>*<span class="number">10</span>;i++)</span><br><span class="line">    &#123;</span><br><span class="line">        copyByFileStream(fromeFile, toFile);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">long</span> end=System.currentTimeMillis();</span><br><span class="line">    </span><br><span class="line">    System.out.println(<span class="string">"使用FileInputStream和FileOutputStream逐个数组复制文件用时:"</span>+(end-start));</span><br><span class="line">    start=System.currentTimeMillis();</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;<span class="number">1000</span>*<span class="number">10</span>;i++)</span><br><span class="line">    &#123;</span><br><span class="line">        copyByBufferedStream(fromeFile, toFile);</span><br><span class="line">    &#125;</span><br><span class="line">    end=System.currentTimeMillis();</span><br><span class="line">    System.out.println(<span class="string">"使用BufferdInputStream和BufferedOutputStream逐个数组复制文件用(数组长度比内部缓存大)时:"</span>+(end-start));</span><br><span class="line">    start=System.currentTimeMillis();</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;<span class="number">1000</span>*<span class="number">10</span>;i++)</span><br><span class="line">    &#123;</span><br><span class="line">        copyByBufferedStream2(fromeFile, toFile);</span><br><span class="line">    &#125;</span><br><span class="line">    end=System.currentTimeMillis();</span><br><span class="line">    System.out.println(<span class="string">"使用BufferdInputStream和BufferedOutputStream逐个数组复制文件用(数组长度比内部缓存小)时:"</span>+(end-start));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p></p><p>运行结果：<br></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">使用FileInputStream和FileOutputStream逐个数组复制文件用时:<span class="number">15744</span></span><br><span class="line">使用BufferdInputStream和BufferedOutputStream逐个数组复制文件用(数组长度比内部缓存大)时:<span class="number">14805</span></span><br><span class="line">使用BufferdInputStream和BufferedOutputStream逐个数组复制文件用(数组长度比内部缓存小)时:<span class="number">13605</span></span><br></pre></td></tr></table></figure><p></p><p>可以看到虽然每次读取量为10240字节时，</p><ul><li>使用默认长度的缓冲流，还是比直接使用文件流要快。(如果每次读写的都是10240个字节的话，他们应该一样快才是)</li><li>而缓存大的比缓存小的读写块(这很明显)</li><li>缓存大于读写量的效率比，缓存小于读写量的好(因为有时放不到缓存中，这跟使用第一个方法效果一样)</li></ul><h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>不管是一个字节一个字节的读写，还是一个数组一个数组的读写，使用缓冲流(BufferedInputStream/BufferedOutputSteam)都比使用文件流(FileInputStream/FileOutputStream)效率要好。<br>还有就是应该使得缓冲区的长度比每次读写的数组长度大,这样效率比较好。</p><p>本文链接: <a href="https://www.lansheng.net.cn/blog/d2ebfe94/">文件流和缓冲流的比较_输出缓冲流源码详解</a></p></div><footer class="post-footer"><div class="post-eof"></div></footer></div></article><article class="post post-type-normal" itemscope itemtype="http://schema.org/Article"><div class="post-block"><link itemprop="mainEntityOfPage" href="https://www.lansheng.net.cn/blog/1ae845fa/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="name" content="蓝生"><meta itemprop="description" content=""><meta itemprop="image" content="/images/avatar.jpg"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="蓝生的博客"></span><header class="post-header"><h1 class="post-title" itemprop="name headline"><a class="post-title-link" href="/blog/1ae845fa/" itemprop="url">测试格式化</a></h1><div class="post-meta"><span class="post-time"><span class="post-meta-item-icon"><i class="fa fa-calendar-o"></i> </span><span class="post-meta-item-text">发表于</span> <time title="创建时间：2018-07-31 14:18:47" itemprop="dateCreated datePublished" datetime="2018-07-31T14:18:47+08:00">2018-07-31</time> <span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="fa fa-calendar-check-o"></i> </span><span class="post-meta-item-text">更新于</span> <time title="修改时间：2018-11-05 17:17:08" itemprop="dateModified" datetime="2018-11-05T17:17:08+08:00">2018-11-05</time> </span><span class="post-category"><span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="fa fa-folder-o"></i> </span><span class="post-meta-item-text">分类于</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/其他/" itemprop="url" rel="index"><span itemprop="name">其他</span></a></span> </span><span class="post-comments-count"><span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="fa fa-comment-o"></i> </span><a href="/blog/1ae845fa/#comments" itemprop="discussionUrl"><span class="post-meta-item-text">评论数：</span> <span class="post-comments-count valine-comment-count" data-xid="/blog/1ae845fa/" itemprop="commentCount"></span></a></span></div></header><div class="post-body" itemprop="articleBody"><ul><li>支持：throws.*这种单起一行的语句–&gt;缩进四个空格</li><li>支持：单行注释的缩进</li><li>修复：遇到仅仅一行<code>{</code>的时候多打换行的bug</li><li>说明：上面只对，VC样式的代码进行优化。</li></ul><p><strong>代码如下：</strong><br><strong>CodeFormat.java:</strong><br></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> code.format;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.Scanner;</span><br><span class="line"><span class="keyword">import</span> java.util.regex.Matcher;</span><br><span class="line"><span class="keyword">import</span> java.util.regex.Pattern;</span><br><span class="line"><span class="comment">//import clipboard.util.SysClipboardUtil;</span></span><br><span class="line"><span class="keyword">import</span> clipboard.util.SysClipboardUtil;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CodeFormat</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		String text = SysClipboardUtil.getSysClipboardText();</span><br><span class="line">		System.out.println(<span class="string">"接收到的文本:"</span>);</span><br><span class="line">		System.out.println(<span class="string">"------------------------------------"</span>);</span><br><span class="line">		System.out.println(text);</span><br><span class="line">		System.out.println(<span class="string">"------------------------------------"</span>);</span><br><span class="line">		System.out.println(<span class="string">"java方式的格式化："</span>);</span><br><span class="line">		System.out.println(<span class="string">"------------------------------------"</span>);</span><br><span class="line">		System.out.println(formatLikeJava(text));</span><br><span class="line">		System.out.println(<span class="string">"------------------------------------"</span>);</span><br><span class="line">		System.out.println(<span class="string">"VC方式的格式化："</span>);</span><br><span class="line">		System.out.println(<span class="string">"------------------------------------"</span>);</span><br><span class="line">		System.out.println(formatLikeVC(text));</span><br><span class="line">		System.out.println(<span class="string">"------------------------------------"</span>);</span><br><span class="line"></span><br><span class="line">	&#125;<span class="comment">// main结束</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">/**   </span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@param</span> unformattedCode  </span></span><br><span class="line"><span class="comment">	 */</span>  </span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> String <span class="title">formatLikeJava</span><span class="params">(String unformattedCode)</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		<span class="comment">//tab键：4个空格</span></span><br><span class="line">		<span class="keyword">final</span> String Tab = <span class="string">"    "</span>;</span><br><span class="line">		StringBuilder TabBuider = <span class="keyword">new</span> StringBuilder();</span><br><span class="line">		StringBuilder formatedCode=<span class="keyword">new</span> StringBuilder();</span><br><span class="line">		Scanner scanner = <span class="keyword">new</span> Scanner(unformattedCode);</span><br><span class="line">		String line = <span class="keyword">null</span>;</span><br><span class="line">		<span class="keyword">while</span> (scanner.hasNextLine())</span><br><span class="line">		&#123;</span><br><span class="line">			line = scanner.nextLine().trim();</span><br><span class="line">			<span class="keyword">if</span> (line.matches(<span class="string">".*\\&#125;.*$"</span>))</span><br><span class="line">			&#123;</span><br><span class="line">				TabBuider.delete(<span class="number">0</span>, <span class="number">4</span>);</span><br><span class="line"><span class="comment">//				System.out.println(TabBuider.toString() + line);</span></span><br><span class="line">				formatedCode.append(TabBuider.toString() + line+<span class="string">"\n"</span>);</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">else</span> <span class="keyword">if</span> (line.matches(<span class="string">".*\\&#123;.*$"</span>))</span><br><span class="line">			&#123;</span><br><span class="line">				<span class="comment">//vs样式的格式化：</span></span><br><span class="line"><span class="comment">//				System.out.println(TabBuider.toString() + line.substring(0,line.lastIndexOf('&#123;')));</span></span><br><span class="line"><span class="comment">//				System.out.println(TabBuider.toString()+line.substring(line.lastIndexOf('&#123;')));</span></span><br><span class="line">				<span class="comment">//Java样式的格式化：</span></span><br><span class="line"><span class="comment">//				System.out.println(TabBuider.toString()+line);</span></span><br><span class="line">				formatedCode.append(TabBuider.toString()+line+<span class="string">"\n"</span>);</span><br><span class="line">				TabBuider.append(Tab);</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">else</span> <span class="keyword">if</span>(line.matches(<span class="string">"^throws.*$"</span>))</span><br><span class="line">			&#123;</span><br><span class="line">				formatedCode.append(Tab + line+<span class="string">"\n"</span>);</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">else</span> &#123;</span><br><span class="line"><span class="comment">//				System.out.println(TabBuider.toString() + line);</span></span><br><span class="line">				formatedCode.append(TabBuider.toString() + line+<span class="string">"\n"</span>);</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		scanner.close();</span><br><span class="line">		<span class="keyword">return</span> formatedCode.toString();</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">/**   </span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@param</span> unformattedCode  </span></span><br><span class="line"><span class="comment">	 */</span>  </span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> String <span class="title">formatLikeVC</span><span class="params">(String unformattedCode)</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		<span class="keyword">final</span> String Tab = <span class="string">"    "</span>;</span><br><span class="line">		StringBuilder TabBuider = <span class="keyword">new</span> StringBuilder();</span><br><span class="line">		StringBuilder formatedCode=<span class="keyword">new</span> StringBuilder();</span><br><span class="line">		Scanner scanner = <span class="keyword">new</span> Scanner(unformattedCode);</span><br><span class="line">		String line = <span class="keyword">null</span>;</span><br><span class="line">		<span class="keyword">while</span> (scanner.hasNextLine())</span><br><span class="line">		&#123;</span><br><span class="line">			line = scanner.nextLine().trim();</span><br><span class="line"><span class="comment">//			System.out.println("--&gt;"+line);</span></span><br><span class="line">			<span class="keyword">if</span> (line.matches(<span class="string">".*\\&#125;.*$"</span>))</span><br><span class="line">			&#123;</span><br><span class="line">				TabBuider.delete(<span class="number">0</span>, <span class="number">4</span>);</span><br><span class="line"><span class="comment">//				System.out.println(TabBuider.toString() + line);</span></span><br><span class="line">				formatedCode.append(TabBuider.toString() + line+<span class="string">"\n"</span>);</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="comment">//如果这一行只有一个开括号，就不用再分割了</span></span><br><span class="line">			<span class="keyword">else</span> <span class="keyword">if</span>(line.matches(<span class="string">"\\&#123;"</span>))</span><br><span class="line">			&#123;</span><br><span class="line">				formatedCode.append(TabBuider.toString() + line+<span class="string">"\n"</span>);</span><br><span class="line">				TabBuider.append(Tab);</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">else</span> <span class="keyword">if</span> (line.matches(<span class="string">".*\\&#123;.*$"</span>))</span><br><span class="line">			&#123;</span><br><span class="line">				<span class="comment">//vs样式的格式化：</span></span><br><span class="line"><span class="comment">//				System.out.println(TabBuider.toString() + line.substring(0,line.lastIndexOf('&#123;')));</span></span><br><span class="line"><span class="comment">//				System.out.println(TabBuider.toString()+line.substring(line.lastIndexOf('&#123;')));</span></span><br><span class="line">				formatedCode.append(TabBuider.toString() + line.substring(<span class="number">0</span>,line.lastIndexOf(<span class="string">'&#123;'</span>))+<span class="string">"\n"</span>);</span><br><span class="line">				formatedCode.append(TabBuider.toString()+line.substring(line.lastIndexOf(<span class="string">'&#123;'</span>))+<span class="string">"\n"</span>);</span><br><span class="line"><span class="comment">//				//Java样式的格式化：</span></span><br><span class="line"><span class="comment">//				System.out.println(TabBuider.toString()+line);</span></span><br><span class="line">				TabBuider.append(Tab);</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">else</span> <span class="keyword">if</span>(line.matches(<span class="string">"^throws.*$"</span>))<span class="comment">//匹配抛出异常语句</span></span><br><span class="line">			&#123;</span><br><span class="line">				formatedCode.append(Tab + line+<span class="string">"\n"</span>);</span><br><span class="line">			&#125;</span><br><span class="line"><span class="comment">//			else if(line.matches("^//(\\s+).*$"))//匹配行注释,替换其中的空白符</span></span><br><span class="line">			<span class="keyword">else</span> <span class="keyword">if</span>(line.matches(<span class="string">"^//(\\s+).*$"</span>))<span class="comment">//匹配行注释,替换其中的空白符</span></span><br><span class="line">			&#123;</span><br><span class="line">				<span class="comment">//总感觉这里应该怎么优化一下，匹配两次正则</span></span><br><span class="line">				Pattern pattern=Pattern.compile(<span class="string">"^//(\\s+).*$"</span>);</span><br><span class="line">				Matcher matcher = pattern.matcher(line);</span><br><span class="line"><span class="comment">//				System.out.println(matcher.matches());</span></span><br><span class="line"><span class="comment">//				Pattern.compile("^//(\\s+).*$").matcher(line).matches();</span></span><br><span class="line">				</span><br><span class="line">				</span><br><span class="line">				matcher.find();<span class="comment">//查找捕获组</span></span><br><span class="line">				<span class="comment">//使用缩进替换空白符,因为注释符本省占两个字节，所以缩进空格少打两个</span></span><br><span class="line">				line=line.replaceAll(<span class="string">"\\s+"</span>, TabBuider.toString().substring(<span class="number">2</span>));</span><br><span class="line"><span class="comment">//				System.out.println("#---&gt;"+line);</span></span><br><span class="line">				formatedCode.append(line+<span class="string">"\n"</span>);</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">else</span> &#123;</span><br><span class="line"><span class="comment">//				System.out.println(TabBuider.toString() + line);</span></span><br><span class="line">				formatedCode.append(TabBuider.toString() + line+<span class="string">"\n"</span>);</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		scanner.close();</span><br><span class="line">		<span class="keyword">return</span> formatedCode.toString();</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p></p><p>参考文章：<a href="https://blog.csdn.net/just4you/article/details/70767928" target="_blank" rel="noopener">正则表达式的捕获组(capture group)在Java中的使用</a></p><p>本文链接: <a href="https://www.lansheng.net.cn/blog/1ae845fa/">测试格式化</a></p></div><footer class="post-footer"><div class="post-eof"></div></footer></div></article><article class="post post-type-normal" itemscope itemtype="http://schema.org/Article"><div class="post-block"><link itemprop="mainEntityOfPage" href="https://www.lansheng.net.cn/blog/b72cf8a8/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="name" content="蓝生"><meta itemprop="description" content=""><meta itemprop="image" content="/images/avatar.jpg"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="蓝生的博客"></span><header class="post-header"><h1 class="post-title" itemprop="name headline"><a class="post-title-link" href="/blog/b72cf8a8/" itemprop="url">Java IO流操作二 缓冲流</a></h1><div class="post-meta"><span class="post-time"><span class="post-meta-item-icon"><i class="fa fa-calendar-o"></i> </span><span class="post-meta-item-text">发表于</span> <time title="创建时间：2018-07-30 20:40:53" itemprop="dateCreated datePublished" datetime="2018-07-30T20:40:53+08:00">2018-07-30</time> <span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="fa fa-calendar-check-o"></i> </span><span class="post-meta-item-text">更新于</span> <time title="修改时间：2018-11-05 17:17:08" itemprop="dateModified" datetime="2018-11-05T17:17:08+08:00">2018-11-05</time> </span><span class="post-category"><span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="fa fa-folder-o"></i> </span><span class="post-meta-item-text">分类于</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/其他/" itemprop="url" rel="index"><span itemprop="name">其他</span></a></span> </span><span class="post-comments-count"><span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="fa fa-comment-o"></i> </span><a href="/blog/b72cf8a8/#comments" itemprop="discussionUrl"><span class="post-meta-item-text">评论数：</span> <span class="post-comments-count valine-comment-count" data-xid="/blog/b72cf8a8/" itemprop="commentCount"></span></a></span></div></header><div class="post-body" itemprop="articleBody"><p><strong>IO的缓冲区的存在就是为了提高效率,把要操作的数据放进缓冲区,然后一次性把缓冲区的内容写到目的地,而不是写一次就往目的地写一次.</strong><br>在这里要注意的是当我们<strong>关闭了缓冲区对象实际也关闭了与缓冲区关联的流对象</strong>.<br>BufferWriter类</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">FileWriter fw =<span class="keyword">null</span>;</span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">    fw =<span class="keyword">new</span> FileWriter(<span class="string">"test.txt"</span>);</span><br><span class="line">    <span class="comment">//使用缓冲区必须要与一个流对象相关联</span></span><br><span class="line">    BufferedWriter bw =<span class="keyword">new</span> BufferedWriter(fw);</span><br><span class="line">    <span class="comment">//写入缓冲</span></span><br><span class="line">    bw.write(<span class="string">"hello world!"</span>);</span><br><span class="line">    <span class="comment">//使用缓冲区的时候要注意刷新</span></span><br><span class="line">    bw.flush();</span><br><span class="line">    <span class="comment">//关闭缓冲区的对象,实际上是关闭与它关联的流对象最好放在finally执行</span></span><br><span class="line">    bw.close();</span><br><span class="line">&#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">e.printStackTrace();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>其实BufferReader也是差不多的,这里就不多讲</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">FileReader fr =<span class="keyword">new</span> FileReader(<span class="string">"test.txt"</span>);</span><br><span class="line">BufferedReader br =<span class="keyword">new</span> BufferedReader(fr);</span><br><span class="line">String line =<span class="keyword">null</span>;</span><br><span class="line"><span class="comment">//注意readLine方法读取的内容不包括换行符</span></span><br><span class="line"><span class="keyword">while</span>((line=br.readLine())!=<span class="keyword">null</span>)</span><br><span class="line">&#123;</span><br><span class="line">    System.out.println(line);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>readLine原理:</strong><br>无论是读一行,获取多个字符,最终都是在硬盘上一个一个读取,所以最终使用的还是read方法一次读一个的方法.</p><h2 id="装饰模式"><a href="#装饰模式" class="headerlink" title="装饰模式:"></a>装饰模式:</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span></span></span><br><span class="line"><span class="class"></span>&#123; </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">eat</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123; </span><br><span class="line">        System.out.println(<span class="string">"吃饭"</span>); </span><br><span class="line">    &#125; </span><br><span class="line">&#125; </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">PersonEnhance</span></span></span><br><span class="line"><span class="class"></span>&#123; </span><br><span class="line">    <span class="keyword">private</span> Person p;</span><br><span class="line">    <span class="comment">//把需要增强 的类传进去初始化</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">PersonEnhance</span><span class="params">(Person p)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.p=p;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">enhanceEat</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"开胃酒"</span>); </span><br><span class="line">        p.eat(); </span><br><span class="line">        System.out.println(<span class="string">"甜点"</span>); </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>装饰模式就是在原有类的基础上把某个方法增强功能</strong></p><p>但是这让我想到了java 的动态代理,他也是在某个方法的基础上增加额外的功能,那么她们有什么区别呢?</p><h3 id="装饰模式和动态代理的区别"><a href="#装饰模式和动态代理的区别" class="headerlink" title="装饰模式和动态代理的区别"></a>装饰模式和动态代理的区别</h3><p><strong>装饰类和被装饰的类是应该继承或实现相同的接口,而java的动态代理不是</strong>,<br>还有一个不同点就是<strong>动态代理可以</strong>横切多个面,也就是<strong>同时对多个方法进行增强</strong>.</p><p>通过装饰模式和继承的区别发现了程序设计之美,虽然继承也可以增强某个方法,但是它使得类的体系很臃肿,并且可扩展性不好</p><p>因为装饰模式中,我们可以把被装饰类的父类当作参数传进装饰类的构造方法内,那么你这一个装饰类就可以应用于这个体系的了,这也是java多态性的好处.<br>相比较之下使用装饰模式降低了类之间的关系.<br>装饰类是因为增强了已有的对象,具有的功能和已有的是相同的,是不过提供了更强的功能,所以装饰类和被装饰类通常属于一个体系中的.</p><p>在API中可以看到BufferedReader类还有一个子类LineNumberReader</p><p>通过API对得知,这是一个字符缓冲输出流,该类保持对行号的跟踪,可以通过该类的setLineNumber(int) 和 getLineNumber() 方法分别设置获取行号<br>例如程序:</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> lan.base;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.FileReader;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.LineNumberReader;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestLineNumberReader</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span><span class="keyword">throws</span> IOException</span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">	    FileReader fr =<span class="keyword">new</span> FileReader(<span class="string">".\\src\\lan\\base\\TestLineNumberReader.java"</span>);</span><br><span class="line">	    LineNumberReader lnr =<span class="keyword">new</span> LineNumberReader(fr);</span><br><span class="line">	    String line =<span class="keyword">null</span>;</span><br><span class="line">	    <span class="keyword">while</span>((line=lnr.readLine())!=<span class="keyword">null</span>)</span><br><span class="line">	    &#123;</span><br><span class="line">	        System.out.println(lnr.getLineNumber()+<span class="string">":"</span>+line);</span><br><span class="line">	    &#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>控制台输出:<br></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">1:package lan.base;</span><br><span class="line">2:</span><br><span class="line">3:import java.io.FileReader;</span><br><span class="line">4:import java.io.IOException;</span><br><span class="line">5:import java.io.LineNumberReader;</span><br><span class="line">6:</span><br><span class="line">7:public class TestLineNumberReader</span><br><span class="line">8:&#123;</span><br><span class="line">9:	public static void main(String[] args)throws IOException</span><br><span class="line">10:	&#123;</span><br><span class="line">11:	    FileReader fr =new FileReader(&quot;.\\src\\lan\\base\\TestLineNumberReader.java&quot;);</span><br><span class="line">12:	    LineNumberReader lnr =new LineNumberReader(fr);</span><br><span class="line">13:	    String line =null;</span><br><span class="line">14:	    while((line=lnr.readLine())!=null)</span><br><span class="line">15:	    &#123;</span><br><span class="line">16:	        System.out.println(lnr.getLineNumber()+&quot;:&quot;+line);</span><br><span class="line">17:	    &#125;</span><br><span class="line">18:	&#125;</span><br><span class="line">19:&#125;</span><br></pre></td></tr></table></figure><p></p><p>但是我们也可以改变行号的开始值<br></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span><span class="keyword">throws</span> IOException</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    FileReader fr =<span class="keyword">new</span> FileReader(<span class="string">".\\src\\lan\\base\\TestLineNumberReader.java"</span>);</span><br><span class="line">    LineNumberReader lnr =<span class="keyword">new</span> LineNumberReader(fr);</span><br><span class="line">    String num =<span class="keyword">null</span>;</span><br><span class="line">    <span class="comment">//设置行号的开始值为100</span></span><br><span class="line">    lnr.setLineNumber(<span class="number">100</span>);</span><br><span class="line">    <span class="keyword">while</span>((num=lnr.readLine())!=<span class="keyword">null</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        System.out.println(lnr.getLineNumber()+<span class="string">":"</span>+num);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p></p><p>输出结果为:<br></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">101:package lan.base;</span><br><span class="line">102:</span><br><span class="line">103:import java.io.FileReader;</span><br><span class="line">104:import java.io.IOException;</span><br><span class="line">105:import java.io.LineNumberReader;</span><br><span class="line">106:</span><br><span class="line">107:public class TestLineNumberReader</span><br><span class="line">108:&#123;</span><br><span class="line">109:	public static void main(String[] args) throws IOException</span><br><span class="line">110:	&#123;</span><br><span class="line">111:		FileReader fr = new FileReader(</span><br><span class="line">112:				&quot;.\\src\\lan\\base\\TestLineNumberReader.java&quot;);</span><br><span class="line">113:		LineNumberReader lnr = new LineNumberReader(fr);</span><br><span class="line">114:		String line = null;</span><br><span class="line">115:		// 设置行号的开始值为100</span><br><span class="line">116:		lnr.setLineNumber(100);</span><br><span class="line">117:		while ((line = lnr.readLine()) != null)</span><br><span class="line">118:		&#123;</span><br><span class="line">119:			System.out.println(lnr.getLineNumber() + &quot;:&quot; + line);</span><br><span class="line">120:		&#125;</span><br><span class="line">121:	&#125;</span><br><span class="line">122:&#125;</span><br></pre></td></tr></table></figure><p></p><h2 id="字节流"><a href="#字节流" class="headerlink" title="字节流"></a>字节流</h2><p>下面开始学习字节流<br>通过<code>API</code>文档字节流的顶级类为<code>InputStream</code>和<code>OutputStream</code><br>首先来看一下<code>FileOutputStream</code>和<code>FileInputStream</code></p><h3 id="使用FileOutStrem写文件"><a href="#使用FileOutStrem写文件" class="headerlink" title="使用FileOutStrem写文件"></a>使用FileOutStrem写文件</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">writeData</span><span class="params">()</span><span class="keyword">throws</span> Exception</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    OutputStream out =<span class="keyword">new</span> FileOutputStream(<span class="string">"D:\\test2.txt"</span>);</span><br><span class="line">    out.write(<span class="string">"hello inputStream!"</span>.getBytes());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>执行上面代码后,发现在D盘创建了test2.txt文件并且内容是hello inputStream!<br>从上面可以看出这和字符流是有区别的,因为当我们在使用字符流的时候,如果没有刷新并且没有关闭那么文件内容是空的,而这里刚好相反.<br>但是最好我们还是调用close方法,关闭资源.提高性能.</p><h3 id="使用FileInputStream读文件"><a href="#使用FileInputStream读文件" class="headerlink" title="使用FileInputStream读文件"></a>使用FileInputStream读文件</h3><p>下面实现读取操作</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">readData</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    InputStream is = <span class="keyword">new</span> FileInputStream(<span class="string">"D:\\test2.txt"</span>);</span><br><span class="line">    <span class="keyword">int</span> num = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> ((num = is.read()) != -<span class="number">1</span>) </span><br><span class="line">    &#123;</span><br><span class="line">        System.out.print((<span class="keyword">char</span>) num);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>输出结果：<br></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hello inputStream!</span><br></pre></td></tr></table></figure><p></p><p>但是这样效率比较低,因为读取一次写一次。我们可以一次读取一个字节数组。<br></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">readData2</span><span class="params">()</span><span class="keyword">throws</span> IOException </span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    InputStream is =<span class="keyword">new</span> FileInputStream(<span class="string">"D:\\test2.txt"</span>);</span><br><span class="line">    <span class="keyword">int</span> num = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">byte</span>[] buffer =<span class="keyword">new</span> <span class="keyword">byte</span>[<span class="number">1024</span>];</span><br><span class="line">    <span class="comment">//把读取到的数据放进字节数组里面</span></span><br><span class="line">    <span class="keyword">while</span> ((num = is.read(buffer)) != -<span class="number">1</span>) </span><br><span class="line">    &#123;</span><br><span class="line">        System.out.println(<span class="keyword">new</span> String(buffer, <span class="number">0</span>, num));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p></p><p>##获取文件的长度<br>在InputStream类中有这样一个方法available(),该方法的作用是返回文件内容的长度。那么我们就可以把字节数组的长度定义成文件长度,则这个数组就刚好装下这个文件的所有字节。这样读取数据就不需要使用while循环了</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">publicstaticvoid <span class="title">readData3</span><span class="params">()</span><span class="keyword">throws</span> IOException </span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    InputStream is =<span class="keyword">new</span> FileInputStream(<span class="string">"D:\\test2.txt"</span>);</span><br><span class="line">    <span class="comment">//返回文件的长度</span></span><br><span class="line">    <span class="keyword">int</span> num = is.available();</span><br><span class="line">    <span class="comment">//把字节数组的长度定义成文件长度,那么这个数组就刚好装下这个文件了</span></span><br><span class="line">    <span class="keyword">byte</span>[] buffer =newbyte[num];</span><br><span class="line">    is.read(buffer);</span><br><span class="line">    System.out.println(<span class="keyword">new</span> String(buffer));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>但是这样有一个缺陷,如果一个文件非常大,该文件的长度(字节数)超出了int的最大表示范围(2.147483647GB)，就会出现内存溢出了.这样获取的文件长度不对，所以这个方法只能用于操作小型的文件.</p><h2 id="使用FileInputSteam和FileOutputStream复制文件"><a href="#使用FileInputSteam和FileOutputStream复制文件" class="headerlink" title="使用FileInputSteam和FileOutputStream复制文件"></a>使用FileInputSteam和FileOutputStream复制文件</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">       <span class="comment">/**   </span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@throws</span> FileNotFoundException</span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@throws</span> IOException  </span></span><br><span class="line"><span class="comment">	 */</span>  </span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">copyByFileStream</span><span class="params">(String fromPath,String toPath)</span></span></span><br><span class="line"><span class="function">			<span class="keyword">throws</span> FileNotFoundException, IOException</span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		InputStream is = <span class="keyword">new</span> FileInputStream(fromPath);</span><br><span class="line">		OutputStream os = <span class="keyword">new</span> FileOutputStream(toPath);</span><br><span class="line">		<span class="comment">//缓冲数组</span></span><br><span class="line">		<span class="keyword">byte</span>[] buffer = <span class="keyword">new</span> <span class="keyword">byte</span>[<span class="number">1024</span>];</span><br><span class="line">		<span class="keyword">int</span> readNum = <span class="number">0</span>;</span><br><span class="line">		<span class="keyword">int</span> a=<span class="number">0</span>;</span><br><span class="line">		<span class="comment">//每次从输入流读取一个数字</span></span><br><span class="line">		<span class="keyword">while</span>((readNum=is.read(buffer))!=-<span class="number">1</span>)</span><br><span class="line">		&#123;</span><br><span class="line"><span class="comment">//		    System.out.println(a++);</span></span><br><span class="line">		<span class="comment">//写入到输出流中</span></span><br><span class="line">		    os.write(buffer, <span class="number">0</span>, readNum);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure><p>使用java缓冲输出流<br></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">BufferedOutputStream buffOs =<span class="keyword">new</span> BufferedOutputStream(<span class="keyword">new</span> FileOutputStream(<span class="string">"F:\\KuGou\\baby2 - baby one more time.mp3"</span>));</span><br><span class="line">BufferedInputStream buffIs =<span class="keyword">new</span> BufferedInputStream(<span class="keyword">new</span> FileInputStream(<span class="string">"F:\\KuGou\\baby - baby one more time.mp3"</span>));</span><br><span class="line"><span class="keyword">int</span> len = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">while</span>((len=buffIs.read())!=-<span class="number">1</span>)</span><br><span class="line">&#123;</span><br><span class="line">    buffOs.write(len);</span><br><span class="line">&#125;</span><br><span class="line">buffOs.close();</span><br><span class="line">buffIs.close();</span><br></pre></td></tr></table></figure><p></p><p>获取键盘录入:<br>System.out对应的是标准的输出设备一般指控制台<br>System.in对应的是标准输入设备:键盘<br>下面模拟一个键盘录入的功能:<br>publicstaticvoid main(String[] args)throws IOException {<br>InputStream is = System.in;<br>StringBuilder buffer =new StringBuilder();<br>int i = 0;<br>while (true) {<br>i = is.read();<br>if (‘\r’ == i)<br>continue;<br>if (‘\n’ == i) {<br>String value = buffer.toString();<br>//如果录入的是over那么则退出<br>if (“over”.equals(buffer.toString()))<br>break;<br>System.out.println(value);<br>//清空缓冲区 以免下次录入时不会和前面录入的汇合<br>buffer.delete(0, buffer.length());<br>}<br>else {<br>buffer.append((char)i);<br>}<br>}<br>}<br>注意在输入流在读取数据的时候连回车也会读取的.在windows中\r\n代表换行 例如下面简单的程序<br>InputStream is = System.in;<br>System.out.println(is.read());<br>System.out.println(is.read());<br>控制台输出:<br>13<br>10<br>对于键盘录入功能我们可以使用更加简单的方式:因为他这个功能实际上就是读取一行 的操作:<br>那么就可以考虑使用readLine方法,然后该方法是字符六BufferedReader的方法<br>然而InputStream又是字节流.那么怎么办呢?<br>我们可以使用InputStreamReader类,这个类是字节流到字符流的桥梁,<br>publicstaticvoid main(String[] args)throws IOException {<br>InputStream is = System.in;<br>InputStreamReader isr =new InputStreamReader(is);<br>BufferedReader br =new BufferedReader(isr);<br>String line =null;<br>while((line=br.readLine())!=null){<br>if(line.equals(“over”)){<br>break;<br>}<br>System.out.println(line.toUpperCase());<br>}<br>}</p><p>对应的OutputStreamWriter是字符流向字节流转换的桥梁 也就是读进来的是字符,写进去的是字节,在上面的基础上我们可以这样改写:<br>publicstaticvoid main(String[] args)throws IOException {<br>InputStream is = System.in;<br>InputStreamReader isr =new InputStreamReader(is);<br>BufferedReader br =new BufferedReader(isr);<br>OutputStreamWriter osw =new OutputStreamWriter(System.out);<br>BufferedWriter bw =new BufferedWriter(osw);<br>String line =null;<br>while((line=br.readLine())!=null){<br>if(line.equals(“over”)){<br>break;<br>}<br>bw.write(line);<br>//注意使用字符流要注意flush<br>bw.flush();<br>//System.out.println(line.toUpperCase());<br>}<br>}<br>但是控制台输出为:</p><p>发现输出的数据没有换行<br>当然我们可以在line后面加上\r\n<br>但是这是不跨品台的<br>我们可以这样解决:<br>我们可以使用<br>BufferedWriter 的newLine方法<br>在bw.write(line);后面加上bw.newLine(); 即可<br>总结: 下面总结一下IO的操作规律:<br>1,明确源和目的:<br>源 :输入流,InputStream Reader<br>目的: 输入流 OutpuStream Writer<br>3当明确体系后,在明确使用哪个具体的对象<br>通过设备来进行区分:<br>源设备: 存 硬盘 键盘<br>目的设备: 内存 硬盘 控制台</p><p>转载请注明 出处: <a href="http://blog.csdn.net/johnny901114/article/details/8710403" target="_blank" rel="noopener">http://blog.csdn.net/johnny901114/article/details/8710403</a></p><p>本文链接: <a href="https://www.lansheng.net.cn/blog/b72cf8a8/">Java IO流操作二 缓冲流</a></p></div><footer class="post-footer"><div class="post-eof"></div></footer></div></article></section><nav class="pagination"><a class="extend prev" rel="prev" href="/page/22/"><i class="fa fa-angle-left" aria-label="上一页"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/22/">22</a><span class="page-number current">23</span><a class="page-number" href="/page/24/">24</a><a class="extend next" rel="next" href="/page/24/"><i class="fa fa-angle-right" aria-label="下一页"></i></a></nav></div></div><div class="sidebar-toggle"><div class="sidebar-toggle-line-wrap"><span class="sidebar-toggle-line sidebar-toggle-line-first"></span> <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span> <span class="sidebar-toggle-line sidebar-toggle-line-last"></span></div></div><aside id="sidebar" class="sidebar"><div class="sidebar-inner"><section class="site-overview-wrap sidebar-panel sidebar-panel-active"><div class="site-overview"><div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person"><img class="site-author-image" itemprop="image" src="/images/avatar.jpg" alt="蓝生"><p class="site-author-name" itemprop="name">蓝生</p><p class="site-description motion-element" itemprop="description"></p></div><nav class="site-state motion-element"><div class="site-state-item site-state-posts"><a href="/archives/"><span class="site-state-item-count">235</span> <span class="site-state-item-name">日志</span></a></div><div class="site-state-item site-state-categories"><a href="/categories/index.html"><span class="site-state-item-count">78</span> <span class="site-state-item-name">分类</span></a></div></nav><div class="feed-link motion-element"><a href="/atom.xml" rel="alternate"><i class="fa fa-rss"></i> RSS</a></div><div class="links-of-author motion-element"><span class="links-of-author-item"><a href="https://blog.csdn.net/qq_21808961" target="_blank" title="CSDN"><i class="fa fa-fw fa-arrow-right"></i>CSDN</a> </span><span class="links-of-author-item"><a href="https://www.shixiseng.com/" target="_blank" title="实习僧"><i class="fa fa-fw fa-arrow-right"></i>实习僧</a></span></div><div class="links-of-blogroll motion-element links-of-blogroll-block"><div class="links-of-blogroll-title"><i class="fa fa-fw fa-link"></i> 友情链接</div><ul class="links-of-blogroll-list"><li class="links-of-blogroll-item"><a href="https://ziyuan.baidu.com/xzh/home/index" title="百度熊掌号" target="_blank">百度熊掌号</a></li><li class="links-of-blogroll-item"><a href="https://ziyuan.baidu.com/linksubmit/index" title="百度链接提交" target="_blank">百度链接提交</a></li><li class="links-of-blogroll-item"><a href="https://reuixiy.github.io/" title="超好看的Hexo+NexT博客" target="_blank">超好看的Hexo+NexT博客</a></li><li class="links-of-blogroll-item"><a href="https://www.face2ai.com/" title="谭升" target="_blank">谭升</a></li></ul></div></div></section></div></aside></div></main><footer id="footer" class="footer"><div class="footer-inner"><div class="copyright">&copy; <span itemprop="copyrightYear">2018</span> <span class="with-love" id="animate"><i class="fa fa-user"></i> </span><span class="author" itemprop="copyrightHolder">蓝生</span></div><div class="theme-info"><div class="powered-by"></div><span class="post-count">博客全站共336.0k字</span></div><div class="busuanzi-count"><script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script><span class="site-uv" title="总访客量"><i class="fa fa-user"></i> <span class="busuanzi-value" id="busuanzi_value_site_uv"></span> </span><span class="site-pv" title="总访问量"><i class="fa fa-eye"></i> <span class="busuanzi-value" id="busuanzi_value_site_pv"></span></span></div></div></footer><div class="back-to-top"><i class="fa fa-arrow-up"></i></div></div><script type="text/javascript">"[object Function]"!==Object.prototype.toString.call(window.Promise)&&(window.Promise=null)</script><script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script><script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script><script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script><script type="text/javascript" src="/js/src/utils.js?v=6.4.0"></script><script type="text/javascript" src="/js/src/motion.js?v=6.4.0"></script><script type="text/javascript" src="/js/src/affix.js?v=6.4.0"></script><script type="text/javascript" src="/js/src/schemes/pisces.js?v=6.4.0"></script><script type="text/javascript" src="/js/src/bootstrap.js?v=6.4.0"></script><script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script><script src="//unpkg.com/valine/dist/Valine.min.js"></script><script type="text/javascript">var GUEST=["nick","mail","link"],guest="nick,mail,link";guest=guest.split(",").filter(function(e){return GUEST.indexOf(e)>-1}),new Valine({el:"#comments",verify:!0,notify:!1,appId:"8uEACQMqUrxjo1Hqof21pkCV-gzGzoHsz",appKey:"DgRm99ypfVS7Mm9YLchO1RGG",placeholder:"在上方填入昵称，邮箱，个人博客地址即可评论",avatar:"mm",meta:guest,pageSize:"10",visitor:!1})</script><script type="text/javascript">function proceedsearch(){$("body").append('<div class="search-popup-overlay local-search-pop-overlay"></div>').css("overflow","hidden"),$(".search-popup-overlay").click(onPopupClose),$(".popup").toggle();var t=$("#local-search-input");t.attr("autocapitalize","none"),t.attr("autocorrect","off"),t.focus()}var isfetched=!1,isXml=!0,search_path="search.xml";0===search_path.length?search_path="search.xml":/json$/i.test(search_path)&&(isXml=!1);var path="/"+search_path,onPopupClose=function(t){$(".popup").hide(),$("#local-search-input").val(""),$(".search-result-list").remove(),$("#no-result").remove(),$(".local-search-pop-overlay").remove(),$("body").css("overflow","")},searchFunc=function(t,e,o){"use strict";$("body").append('<div class="search-popup-overlay local-search-pop-overlay"><div id="search-loading-icon"><i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i></div></div>').css("overflow","hidden"),$("#search-loading-icon").css("margin","20% auto 0 auto").css("text-align","center"),$.ajax({url:t,dataType:isXml?"xml":"json",async:!0,success:function(t){isfetched=!0,$(".popup").detach().appendTo(".header-inner");var n=isXml?$("entry",t).map(function(){return{title:$("title",this).text(),content:$("content",this).text(),url:$("url",this).text()}}).get():t,r=document.getElementById(e),s=document.getElementById(o),a=function(){var t=r.value.trim().toLowerCase(),e=t.split(/[\s\-]+/);e.length>1&&e.push(t);var o=[];if(t.length>0&&n.forEach(function(n){function r(e,o,n,r){for(var s=r[r.length-1],a=s.position,i=s.word,l=[],h=0;a+i.length<=n&&0!=r.length;){i===t&&h++,l.push({position:a,length:i.length});var p=a+i.length;for(r.pop();0!=r.length&&(s=r[r.length-1],a=s.position,i=s.word,p>a);)r.pop()}return c+=h,{hits:l,start:o,end:n,searchTextCount:h}}function s(t,e){var o="",n=e.start;return e.hits.forEach(function(e){o+=t.substring(n,e.position);var r=e.position+e.length;o+='<b class="search-keyword">'+t.substring(e.position,r)+"</b>",n=r}),o+=t.substring(n,e.end)}var a=!1,i=0,c=0,l=n.title.trim(),h=l.toLowerCase(),p=n.content.trim().replace(/<[^>]+>/g,""),u=p.toLowerCase(),f=decodeURIComponent(n.url),d=[],g=[];if(""!=l&&(e.forEach(function(t){function e(t,e,o){var n=t.length;if(0===n)return[];var r=0,s=[],a=[];for(o||(e=e.toLowerCase(),t=t.toLowerCase());(s=e.indexOf(t,r))>-1;)a.push({position:s,word:t}),r=s+n;return a}d=d.concat(e(t,h,!1)),g=g.concat(e(t,u,!1))}),(d.length>0||g.length>0)&&(a=!0,i=d.length+g.length)),a){[d,g].forEach(function(t){t.sort(function(t,e){return e.position!==t.position?e.position-t.position:t.word.length-e.word.length})});var v=[];0!=d.length&&v.push(r(l,0,l.length,d));for(var $=[];0!=g.length;){var C=g[g.length-1],m=C.position,x=C.word,w=m-20,y=m+80;0>w&&(w=0),y<m+x.length&&(y=m+x.length),y>p.length&&(y=p.length),$.push(r(p,w,y,g))}$.sort(function(t,e){return t.searchTextCount!==e.searchTextCount?e.searchTextCount-t.searchTextCount:t.hits.length!==e.hits.length?e.hits.length-t.hits.length:t.start-e.start});var T=parseInt("1");T>=0&&($=$.slice(0,T));var b="";b+=0!=v.length?"<li><a href='"+f+"' class='search-result-title'>"+s(l,v[0])+"</a>":"<li><a href='"+f+"' class='search-result-title'>"+l+"</a>",$.forEach(function(t){b+="<a href='"+f+'\'><p class="search-result">'+s(p,t)+"...</p></a>"}),b+="</li>",o.push({item:b,searchTextCount:c,hitCount:i,id:o.length})}}),1===e.length&&""===e[0])s.innerHTML='<div id="no-result"><i class="fa fa-search fa-5x" /></div>';else if(0===o.length)s.innerHTML='<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>';else{o.sort(function(t,e){return t.searchTextCount!==e.searchTextCount?e.searchTextCount-t.searchTextCount:t.hitCount!==e.hitCount?e.hitCount-t.hitCount:e.id-t.id});var a='<ul class="search-result-list">';o.forEach(function(t){a+=t.item}),a+="</ul>",s.innerHTML=a}};r.addEventListener("input",a),$(".local-search-pop-overlay").remove(),$("body").css("overflow",""),proceedsearch()}})};$(".popup-trigger").click(function(t){t.stopPropagation(),isfetched===!1?searchFunc(path,"local-search-input","local-search-result"):proceedsearch()}),$(".popup-btn-close").click(onPopupClose),$(".popup").click(function(t){t.stopPropagation()}),$(document).on("keyup",function(t){var e=27===t.which&&$(".search-popup").is(":visible");e&&onPopupClose()})</script><script>!function(){var t=document.createElement("script"),s=window.location.protocol.split(":")[0];"https"===s?t.src="https://zz.bdstatic.com/linksubmit/push.js":t.src="http://push.zhanzhang.baidu.com/push.js";var e=document.getElementsByTagName("script")[0];e.parentNode.insertBefore(t,e)}()</script></body></html><script type="text/javascript" src="/js/src/love.js"></script><!-- rebuild by neat -->